<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Data Visualization with ggplot2 | Computational Tools for Reproducible Science</title>
  <meta name="description" content="WILD 6900: Computational Tools for Reproducible Science" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Data Visualization with ggplot2 | Computational Tools for Reproducible Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="WILD 6900: Computational Tools for Reproducible Science" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Data Visualization with ggplot2 | Computational Tools for Reproducible Science" />
  
  <meta name="twitter:description" content="WILD 6900: Computational Tools for Reproducible Science" />
  

<meta name="author" content="Simona Picardi" />


<meta name="date" content="2021-01-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tidyverse.html"/>
<link rel="next" href="geospatial.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Course Material</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#software-requirements-and-installation-instructions"><i class="fa fa-check"></i><b>0.1</b> Software Requirements and Installation Instructions</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#git"><i class="fa fa-check"></i><b>0.1.1</b> Git</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#spreadsheet-editor"><i class="fa fa-check"></i><b>0.1.2</b> Spreadsheet Editor</a></li>
<li class="chapter" data-level="0.1.3" data-path="index.html"><a href="index.html#sqlite"><i class="fa fa-check"></i><b>0.1.3</b> SQLite</a></li>
<li class="chapter" data-level="0.1.4" data-path="index.html"><a href="index.html#r"><i class="fa fa-check"></i><b>0.1.4</b> R</a></li>
<li class="chapter" data-level="0.1.5" data-path="index.html"><a href="index.html#rstudio"><i class="fa fa-check"></i><b>0.1.5</b> RStudio</a></li>
<li class="chapter" data-level="0.1.6" data-path="index.html"><a href="index.html#required-r-packages"><i class="fa fa-check"></i><b>0.1.6</b> Required R Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="project-organization.html"><a href="project-organization.html"><i class="fa fa-check"></i><b>1</b> Project Organization</a><ul>
<li class="chapter" data-level="1.1" data-path="project-organization.html"><a href="project-organization.html#directory-structure"><i class="fa fa-check"></i><b>1.1</b> Directory structure</a><ul>
<li class="chapter" data-level="1.1.1" data-path="project-organization.html"><a href="project-organization.html#overlap"><i class="fa fa-check"></i><b>1.1.1</b> Overlap</a></li>
<li class="chapter" data-level="1.1.2" data-path="project-organization.html"><a href="project-organization.html#minimizing-duplication"><i class="fa fa-check"></i><b>1.1.2</b> Minimizing duplication</a></li>
<li class="chapter" data-level="1.1.3" data-path="project-organization.html"><a href="project-organization.html#self-containedness"><i class="fa fa-check"></i><b>1.1.3</b> Self-containedness</a></li>
<li class="chapter" data-level="1.1.4" data-path="project-organization.html"><a href="project-organization.html#tradeoffs"><i class="fa fa-check"></i><b>1.1.4</b> Tradeoffs</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="project-organization.html"><a href="project-organization.html#golden-rules"><i class="fa fa-check"></i><b>1.2</b> Golden rules</a></li>
<li class="chapter" data-level="1.3" data-path="project-organization.html"><a href="project-organization.html#be-flexible"><i class="fa fa-check"></i><b>1.3</b> Be flexible</a></li>
<li class="chapter" data-level="1.4" data-path="project-organization.html"><a href="project-organization.html#documentation"><i class="fa fa-check"></i><b>1.4</b> Documentation</a></li>
<li class="chapter" data-level="1.5" data-path="project-organization.html"><a href="project-organization.html#naming-files"><i class="fa fa-check"></i><b>1.5</b> Naming files</a><ul>
<li class="chapter" data-level="1.5.1" data-path="project-organization.html"><a href="project-organization.html#computer-readable-file-names"><i class="fa fa-check"></i><b>1.5.1</b> Computer-readable file names</a></li>
<li class="chapter" data-level="1.5.2" data-path="project-organization.html"><a href="project-organization.html#human-readable-file-names"><i class="fa fa-check"></i><b>1.5.2</b> Human-readable file names</a></li>
<li class="chapter" data-level="1.5.3" data-path="project-organization.html"><a href="project-organization.html#file-names-that-work-well-with-default-ordering"><i class="fa fa-check"></i><b>1.5.3</b> File names that work well with default ordering</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="project-organization.html"><a href="project-organization.html#rstudio-projects"><i class="fa fa-check"></i><b>1.6</b> RStudio Projects</a></li>
<li class="chapter" data-level="1.7" data-path="project-organization.html"><a href="project-organization.html#relative-and-absolute-paths"><i class="fa fa-check"></i><b>1.7</b> Relative and absolute paths</a><ul>
<li class="chapter" data-level="1.7.1" data-path="project-organization.html"><a href="project-organization.html#path-separators"><i class="fa fa-check"></i><b>1.7.1</b> Path separators</a></li>
<li class="chapter" data-level="1.7.2" data-path="project-organization.html"><a href="project-organization.html#references"><i class="fa fa-check"></i><b>1.7.2</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="version-control-git.html"><a href="version-control-git.html"><i class="fa fa-check"></i><b>2</b> Version Control with Git</a><ul>
<li class="chapter" data-level="2.1" data-path="version-control-git.html"><a href="version-control-git.html#command-line-basics"><i class="fa fa-check"></i><b>2.1</b> Command line basics</a></li>
<li class="chapter" data-level="2.2" data-path="version-control-git.html"><a href="version-control-git.html#configuring-git"><i class="fa fa-check"></i><b>2.2</b> Configuring Git</a></li>
<li class="chapter" data-level="2.3" data-path="version-control-git.html"><a href="version-control-git.html#getting-help"><i class="fa fa-check"></i><b>2.3</b> Getting help</a></li>
<li class="chapter" data-level="2.4" data-path="version-control-git.html"><a href="version-control-git.html#creating-a-repository"><i class="fa fa-check"></i><b>2.4</b> Creating a repository</a></li>
<li class="chapter" data-level="2.5" data-path="version-control-git.html"><a href="version-control-git.html#tracking-files"><i class="fa fa-check"></i><b>2.5</b> Tracking files</a></li>
<li class="chapter" data-level="2.6" data-path="version-control-git.html"><a href="version-control-git.html#ignoring-files"><i class="fa fa-check"></i><b>2.6</b> Ignoring files</a></li>
<li class="chapter" data-level="2.7" data-path="version-control-git.html"><a href="version-control-git.html#the-3-states"><i class="fa fa-check"></i><b>2.7</b> The 3 states</a></li>
<li class="chapter" data-level="2.8" data-path="version-control-git.html"><a href="version-control-git.html#un-staging-files"><i class="fa fa-check"></i><b>2.8</b> Un-staging files</a></li>
<li class="chapter" data-level="2.9" data-path="version-control-git.html"><a href="version-control-git.html#recovering-a-previous-version-of-a-file"><i class="fa fa-check"></i><b>2.9</b> Recovering a previous version of a file</a></li>
<li class="chapter" data-level="2.10" data-path="version-control-git.html"><a href="version-control-git.html#removing-git"><i class="fa fa-check"></i><b>2.10</b> Removing Git</a></li>
<li class="chapter" data-level="2.11" data-path="version-control-git.html"><a href="version-control-git.html#git-everyday"><i class="fa fa-check"></i><b>2.11</b> Git everyday</a></li>
<li class="chapter" data-level="2.12" data-path="project-organization.html"><a href="project-organization.html#references"><i class="fa fa-check"></i><b>2.12</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="github.html"><a href="github.html"><i class="fa fa-check"></i><b>3</b> Collaborative Science with GitHub</a><ul>
<li class="chapter" data-level="3.1" data-path="github.html"><a href="github.html#adding-a-remote-to-a-local-repository"><i class="fa fa-check"></i><b>3.1</b> Adding a remote to a local repository</a></li>
<li class="chapter" data-level="3.2" data-path="github.html"><a href="github.html#pushing-to-a-remote-repository"><i class="fa fa-check"></i><b>3.2</b> Pushing to a remote repository</a></li>
<li class="chapter" data-level="3.3" data-path="github.html"><a href="github.html#cloning-a-repository"><i class="fa fa-check"></i><b>3.3</b> Cloning a repository</a></li>
<li class="chapter" data-level="3.4" data-path="github.html"><a href="github.html#synchronizing-changes-among-collaborators"><i class="fa fa-check"></i><b>3.4</b> Synchronizing changes among collaborators</a></li>
<li class="chapter" data-level="3.5" data-path="github.html"><a href="github.html#resolving-conflicts"><i class="fa fa-check"></i><b>3.5</b> Resolving conflicts</a></li>
<li class="chapter" data-level="3.6" data-path="github.html"><a href="github.html#avoiding-conflicts"><i class="fa fa-check"></i><b>3.6</b> Avoiding conflicts</a></li>
<li class="chapter" data-level="3.7" data-path="github.html"><a href="github.html#working-with-branches"><i class="fa fa-check"></i><b>3.7</b> Working with branches</a></li>
<li class="chapter" data-level="3.8" data-path="github.html"><a href="github.html#forking-a-repository"><i class="fa fa-check"></i><b>3.8</b> Forking a repository</a></li>
<li class="chapter" data-level="3.9" data-path="github.html"><a href="github.html#pull-requests"><i class="fa fa-check"></i><b>3.9</b> Pull requests</a></li>
<li class="chapter" data-level="3.10" data-path="project-organization.html"><a href="project-organization.html#references"><i class="fa fa-check"></i><b>3.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spreadsheets.html"><a href="spreadsheets.html"><i class="fa fa-check"></i><b>4</b> Best Practices in the Use of Spreadsheets</a><ul>
<li class="chapter" data-level="4.1" data-path="spreadsheets.html"><a href="spreadsheets.html#what-are-spreadsheets-good-for"><i class="fa fa-check"></i><b>4.1</b> What are spreadsheets good for?</a></li>
<li class="chapter" data-level="4.2" data-path="spreadsheets.html"><a href="spreadsheets.html#human-readable-vs.-computer-readable-data"><i class="fa fa-check"></i><b>4.2</b> Human-readable vs. computer-readable data</a></li>
<li class="chapter" data-level="4.3" data-path="spreadsheets.html"><a href="spreadsheets.html#tidydata"><i class="fa fa-check"></i><b>4.3</b> Tidy data</a></li>
<li class="chapter" data-level="4.4" data-path="spreadsheets.html"><a href="spreadsheets.html#problematic-practices"><i class="fa fa-check"></i><b>4.4</b> Problematic practices</a><ul>
<li class="chapter" data-level="4.4.1" data-path="spreadsheets.html"><a href="spreadsheets.html#multiple-variables-in-a-single-column"><i class="fa fa-check"></i><b>4.4.1</b> Multiple variables in a single column</a></li>
<li class="chapter" data-level="4.4.2" data-path="spreadsheets.html"><a href="spreadsheets.html#rows-for-variables-columns-for-observation"><i class="fa fa-check"></i><b>4.4.2</b> Rows for variables, columns for observation</a></li>
<li class="chapter" data-level="4.4.3" data-path="spreadsheets.html"><a href="spreadsheets.html#multiple-tables-in-a-single-spreadsheet"><i class="fa fa-check"></i><b>4.4.3</b> Multiple tables in a single spreadsheet</a></li>
<li class="chapter" data-level="4.4.4" data-path="spreadsheets.html"><a href="spreadsheets.html#multiple-sheets"><i class="fa fa-check"></i><b>4.4.4</b> Multiple sheets</a></li>
<li class="chapter" data-level="4.4.5" data-path="spreadsheets.html"><a href="spreadsheets.html#using-formatting-to-convey-information"><i class="fa fa-check"></i><b>4.4.5</b> Using formatting to convey information</a></li>
<li class="chapter" data-level="4.4.6" data-path="spreadsheets.html"><a href="spreadsheets.html#putting-units-in-cells"><i class="fa fa-check"></i><b>4.4.6</b> Putting units in cells</a></li>
<li class="chapter" data-level="4.4.7" data-path="spreadsheets.html"><a href="spreadsheets.html#using-problematic-column-names"><i class="fa fa-check"></i><b>4.4.7</b> Using problematic column names</a></li>
<li class="chapter" data-level="4.4.8" data-path="spreadsheets.html"><a href="spreadsheets.html#conflating-zeros-and-missing-values"><i class="fa fa-check"></i><b>4.4.8</b> Conflating zeros and missing values</a></li>
<li class="chapter" data-level="4.4.9" data-path="spreadsheets.html"><a href="spreadsheets.html#using-problematic-null-values"><i class="fa fa-check"></i><b>4.4.9</b> Using problematic null values</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="spreadsheets.html"><a href="spreadsheets.html#document-document-document"><i class="fa fa-check"></i><b>4.5</b> Document, document, document!</a></li>
<li class="chapter" data-level="4.6" data-path="project-organization.html"><a href="project-organization.html#references"><i class="fa fa-check"></i><b>4.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="relational-databases.html"><a href="relational-databases.html"><i class="fa fa-check"></i><b>5</b> Relational Databases</a><ul>
<li class="chapter" data-level="5.1" data-path="relational-databases.html"><a href="relational-databases.html#what-is-a-relational-database"><i class="fa fa-check"></i><b>5.1</b> What is a relational database?</a></li>
<li class="chapter" data-level="5.2" data-path="relational-databases.html"><a href="relational-databases.html#why-bothering-with-relational-databases"><i class="fa fa-check"></i><b>5.2</b> Why bothering with relational databases?</a></li>
<li class="chapter" data-level="5.3" data-path="relational-databases.html"><a href="relational-databases.html#database-components"><i class="fa fa-check"></i><b>5.3</b> Database components</a></li>
<li class="chapter" data-level="5.4" data-path="relational-databases.html"><a href="relational-databases.html#database-design-and-architecture"><i class="fa fa-check"></i><b>5.4</b> Database design and architecture</a></li>
<li class="chapter" data-level="5.5" data-path="relational-databases.html"><a href="relational-databases.html#data-types"><i class="fa fa-check"></i><b>5.5</b> Data types</a></li>
<li class="chapter" data-level="5.6" data-path="relational-databases.html"><a href="relational-databases.html#a-first-look-at-our-practice-database"><i class="fa fa-check"></i><b>5.6</b> A first look at our practice database</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sql.html"><a href="sql.html"><i class="fa fa-check"></i><b>6</b> Basics of SQL Language</a><ul>
<li class="chapter" data-level="6.1" data-path="sql.html"><a href="sql.html#the-sql-language"><i class="fa fa-check"></i><b>6.1</b> The SQL language</a></li>
<li class="chapter" data-level="6.2" data-path="sql.html"><a href="sql.html#writing-sql-queries"><i class="fa fa-check"></i><b>6.2</b> Writing SQL queries</a><ul>
<li class="chapter" data-level="6.2.1" data-path="sql.html"><a href="sql.html#limiting-results"><i class="fa fa-check"></i><b>6.2.1</b> Limiting results</a></li>
<li class="chapter" data-level="6.2.2" data-path="sql.html"><a href="sql.html#sorting-results"><i class="fa fa-check"></i><b>6.2.2</b> Sorting results</a></li>
<li class="chapter" data-level="6.2.3" data-path="sql.html"><a href="sql.html#finding-unique-values"><i class="fa fa-check"></i><b>6.2.3</b> Finding unique values</a></li>
<li class="chapter" data-level="6.2.4" data-path="sql.html"><a href="sql.html#filtering"><i class="fa fa-check"></i><b>6.2.4</b> Filtering</a></li>
<li class="chapter" data-level="6.2.5" data-path="sql.html"><a href="sql.html#calculations"><i class="fa fa-check"></i><b>6.2.5</b> Calculations</a></li>
<li class="chapter" data-level="6.2.6" data-path="sql.html"><a href="sql.html#aggregate-functions"><i class="fa fa-check"></i><b>6.2.6</b> Aggregate functions</a></li>
<li class="chapter" data-level="6.2.7" data-path="sql.html"><a href="sql.html#aliases"><i class="fa fa-check"></i><b>6.2.7</b> Aliases</a></li>
<li class="chapter" data-level="6.2.8" data-path="sql.html"><a href="sql.html#grouping"><i class="fa fa-check"></i><b>6.2.8</b> Grouping</a></li>
<li class="chapter" data-level="6.2.9" data-path="sql.html"><a href="sql.html#filtering-based-on-computed-values"><i class="fa fa-check"></i><b>6.2.9</b> Filtering based on computed values</a></li>
<li class="chapter" data-level="6.2.10" data-path="sql.html"><a href="sql.html#null-values"><i class="fa fa-check"></i><b>6.2.10</b> Null values</a></li>
<li class="chapter" data-level="6.2.11" data-path="sql.html"><a href="sql.html#joins"><i class="fa fa-check"></i><b>6.2.11</b> Joins</a></li>
<li class="chapter" data-level="6.2.12" data-path="sql.html"><a href="sql.html#nested-select-statements"><i class="fa fa-check"></i><b>6.2.12</b> Nested <code>SELECT</code> statements</a></li>
<li class="chapter" data-level="6.2.13" data-path="sql.html"><a href="sql.html#order-of-operations"><i class="fa fa-check"></i><b>6.2.13</b> Order of operations</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sql.html"><a href="sql.html#building-a-database"><i class="fa fa-check"></i><b>6.3</b> Building a database</a><ul>
<li class="chapter" data-level="6.3.1" data-path="sql.html"><a href="sql.html#creating-a-new-database-in-sqlite-studio"><i class="fa fa-check"></i><b>6.3.1</b> Creating a new database in SQLite Studio</a></li>
<li class="chapter" data-level="6.3.2" data-path="sql.html"><a href="sql.html#creating-tables"><i class="fa fa-check"></i><b>6.3.2</b> Creating tables</a></li>
<li class="chapter" data-level="6.3.3" data-path="sql.html"><a href="sql.html#adding-constraints"><i class="fa fa-check"></i><b>6.3.3</b> Adding constraints</a></li>
<li class="chapter" data-level="6.3.4" data-path="sql.html"><a href="sql.html#order-of-table-creation"><i class="fa fa-check"></i><b>6.3.4</b> Order of table creation</a></li>
<li class="chapter" data-level="6.3.5" data-path="sql.html"><a href="sql.html#populating-the-tables"><i class="fa fa-check"></i><b>6.3.5</b> Populating the tables</a></li>
<li class="chapter" data-level="6.3.6" data-path="sql.html"><a href="sql.html#autoincrements-as-primary-keys"><i class="fa fa-check"></i><b>6.3.6</b> Autoincrements as primary keys</a></li>
<li class="chapter" data-level="6.3.7" data-path="sql.html"><a href="sql.html#foreign-keys"><i class="fa fa-check"></i><b>6.3.7</b> Foreign keys</a></li>
<li class="chapter" data-level="6.3.8" data-path="sql.html"><a href="sql.html#crossing-existing-information-to-derive-new-tables"><i class="fa fa-check"></i><b>6.3.8</b> Crossing existing information to derive new tables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rsqlite.html"><a href="rsqlite.html"><i class="fa fa-check"></i><b>7</b> Interfacing Databases in R with RSQLite</a><ul>
<li class="chapter" data-level="7.1" data-path="rsqlite.html"><a href="rsqlite.html#the-rsqlite-package"><i class="fa fa-check"></i><b>7.1</b> The RSQLite package</a></li>
<li class="chapter" data-level="7.2" data-path="rsqlite.html"><a href="rsqlite.html#establising-a-database-connection"><i class="fa fa-check"></i><b>7.2</b> Establising a database connection</a></li>
<li class="chapter" data-level="7.3" data-path="rsqlite.html"><a href="rsqlite.html#sending-queries-to-the-database"><i class="fa fa-check"></i><b>7.3</b> Sending queries to the database</a></li>
<li class="chapter" data-level="7.4" data-path="rsqlite.html"><a href="rsqlite.html#a-note-on-reproducibility"><i class="fa fa-check"></i><b>7.4</b> A note on reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>8</b> Dynamic Documents with RMarkdown</a><ul>
<li class="chapter" data-level="8.1" data-path="rmarkdown.html"><a href="rmarkdown.html#what-is-a-dynamic-document"><i class="fa fa-check"></i><b>8.1</b> What is a dynamic document?</a></li>
<li class="chapter" data-level="8.2" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-and-rmarkdown"><i class="fa fa-check"></i><b>8.2</b> Markdown and RMarkdown</a></li>
<li class="chapter" data-level="8.3" data-path="rmarkdown.html"><a href="rmarkdown.html#installing-rmarkdown"><i class="fa fa-check"></i><b>8.3</b> Installing RMarkdown</a></li>
<li class="chapter" data-level="8.4" data-path="rmarkdown.html"><a href="rmarkdown.html#writing-an-rmarkdown-document"><i class="fa fa-check"></i><b>8.4</b> Writing an RMarkdown document</a><ul>
<li class="chapter" data-level="8.4.1" data-path="rmarkdown.html"><a href="rmarkdown.html#creating-the-document"><i class="fa fa-check"></i><b>8.4.1</b> Creating the document</a></li>
<li class="chapter" data-level="8.4.2" data-path="rmarkdown.html"><a href="rmarkdown.html#yaml-headers"><i class="fa fa-check"></i><b>8.4.2</b> YAML headers</a></li>
<li class="chapter" data-level="8.4.3" data-path="rmarkdown.html"><a href="rmarkdown.html#code-chunks"><i class="fa fa-check"></i><b>8.4.3</b> Code chunks</a></li>
<li class="chapter" data-level="8.4.4" data-path="rmarkdown.html"><a href="rmarkdown.html#inline-code"><i class="fa fa-check"></i><b>8.4.4</b> Inline code</a></li>
<li class="chapter" data-level="8.4.5" data-path="rmarkdown.html"><a href="rmarkdown.html#text-formatting"><i class="fa fa-check"></i><b>8.4.5</b> Text formatting</a></li>
<li class="chapter" data-level="8.4.6" data-path="rmarkdown.html"><a href="rmarkdown.html#embedding-images"><i class="fa fa-check"></i><b>8.4.6</b> Embedding images</a></li>
<li class="chapter" data-level="8.4.7" data-path="rmarkdown.html"><a href="rmarkdown.html#adding-a-table-of-contents"><i class="fa fa-check"></i><b>8.4.7</b> Adding a table of contents</a></li>
<li class="chapter" data-level="8.4.8" data-path="rmarkdown.html"><a href="rmarkdown.html#knitting-the-document"><i class="fa fa-check"></i><b>8.4.8</b> Knitting the document</a></li>
<li class="chapter" data-level="8.4.9" data-path="rmarkdown.html"><a href="rmarkdown.html#the-sky-is-the-limit"><i class="fa fa-check"></i><b>8.4.9</b> The sky is the limit!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="github-pages.html"><a href="github-pages.html"><i class="fa fa-check"></i><b>9</b> Automatically Generated Websites with GitHub Pages</a><ul>
<li class="chapter" data-level="9.1" data-path="github-pages.html"><a href="github-pages.html#bookdown"><i class="fa fa-check"></i><b>9.1</b> Bookdown</a><ul>
<li class="chapter" data-level="9.1.1" data-path="github-pages.html"><a href="github-pages.html#creating-a-book"><i class="fa fa-check"></i><b>9.1.1</b> Creating a book</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="github-pages.html"><a href="github-pages.html#publishing-a-book-with-github-pages"><i class="fa fa-check"></i><b>9.2</b> Publishing a book with GitHub Pages</a><ul>
<li class="chapter" data-level="9.2.1" data-path="github-pages.html"><a href="github-pages.html#step-1-set-up-compatibility-with-github-pages"><i class="fa fa-check"></i><b>9.2.1</b> Step 1: Set up compatibility with GitHub Pages</a></li>
<li class="chapter" data-level="9.2.2" data-path="github-pages.html"><a href="github-pages.html#step-2-set-up-git-repository"><i class="fa fa-check"></i><b>9.2.2</b> Step 2: Set up Git repository</a></li>
<li class="chapter" data-level="9.2.3" data-path="github-pages.html"><a href="github-pages.html#step-3-link-git-repository-to-remote-github-repository"><i class="fa fa-check"></i><b>9.2.3</b> Step 3: Link Git repository to remote GitHub repository</a></li>
<li class="chapter" data-level="9.2.4" data-path="github-pages.html"><a href="github-pages.html#step-4-enable-github-pages"><i class="fa fa-check"></i><b>9.2.4</b> Step 4: Enable GitHub Pages</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="github-pages.html"><a href="github-pages.html#maintaining-the-website"><i class="fa fa-check"></i><b>9.3</b> Maintaining the website</a></li>
<li class="chapter" data-level="9.4" data-path="project-organization.html"><a href="project-organization.html#references"><i class="fa fa-check"></i><b>9.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="intro-to-r.html"><a href="intro-to-r.html"><i class="fa fa-check"></i><b>10</b> Introduction to R</a><ul>
<li class="chapter" data-level="10.1" data-path="intro-to-r.html"><a href="intro-to-r.html#getting-started"><i class="fa fa-check"></i><b>10.1</b> Getting started</a></li>
<li class="chapter" data-level="10.2" data-path="intro-to-r.html"><a href="intro-to-r.html#basics-of-r-programming"><i class="fa fa-check"></i><b>10.2</b> Basics of R programming</a><ul>
<li class="chapter" data-level="10.2.1" data-path="intro-to-r.html"><a href="intro-to-r.html#assigning-objects"><i class="fa fa-check"></i><b>10.2.1</b> Assigning objects</a></li>
<li class="chapter" data-level="10.2.2" data-path="intro-to-r.html"><a href="intro-to-r.html#adding-comments"><i class="fa fa-check"></i><b>10.2.2</b> Adding comments</a></li>
<li class="chapter" data-level="10.2.3" data-path="intro-to-r.html"><a href="intro-to-r.html#headers-and-description"><i class="fa fa-check"></i><b>10.2.3</b> Headers and description</a></li>
<li class="chapter" data-level="10.2.4" data-path="intro-to-r.html"><a href="intro-to-r.html#navigating-through-the-script"><i class="fa fa-check"></i><b>10.2.4</b> Navigating through the script</a></li>
<li class="chapter" data-level="10.2.5" data-path="intro-to-r.html"><a href="intro-to-r.html#functions-and-their-arguments"><i class="fa fa-check"></i><b>10.2.5</b> Functions and their arguments</a></li>
<li class="chapter" data-level="10.2.6" data-path="intro-to-r.html"><a href="intro-to-r.html#writing-functions"><i class="fa fa-check"></i><b>10.2.6</b> Writing functions</a></li>
<li class="chapter" data-level="10.2.7" data-path="relational-databases.html"><a href="relational-databases.html#data-types"><i class="fa fa-check"></i><b>10.2.7</b> Data types</a></li>
<li class="chapter" data-level="10.2.8" data-path="intro-to-r.html"><a href="intro-to-r.html#vectors"><i class="fa fa-check"></i><b>10.2.8</b> Vectors</a></li>
<li class="chapter" data-level="10.2.9" data-path="intro-to-r.html"><a href="intro-to-r.html#factors"><i class="fa fa-check"></i><b>10.2.9</b> Factors</a></li>
<li class="chapter" data-level="10.2.10" data-path="intro-to-r.html"><a href="intro-to-r.html#data-frames"><i class="fa fa-check"></i><b>10.2.10</b> Data frames</a></li>
<li class="chapter" data-level="10.2.11" data-path="intro-to-r.html"><a href="intro-to-r.html#dimensions"><i class="fa fa-check"></i><b>10.2.11</b> Dimensions</a></li>
<li class="chapter" data-level="10.2.12" data-path="intro-to-r.html"><a href="intro-to-r.html#subsetting"><i class="fa fa-check"></i><b>10.2.12</b> Subsetting</a></li>
<li class="chapter" data-level="10.2.13" data-path="intro-to-r.html"><a href="intro-to-r.html#logical-conditions"><i class="fa fa-check"></i><b>10.2.13</b> Logical conditions</a></li>
<li class="chapter" data-level="10.2.14" data-path="intro-to-r.html"><a href="intro-to-r.html#lists"><i class="fa fa-check"></i><b>10.2.14</b> Lists</a></li>
<li class="chapter" data-level="10.2.15" data-path="intro-to-r.html"><a href="intro-to-r.html#control-structures"><i class="fa fa-check"></i><b>10.2.15</b> Control structures</a></li>
<li class="chapter" data-level="10.2.16" data-path="intro-to-r.html"><a href="intro-to-r.html#repeating-operations"><i class="fa fa-check"></i><b>10.2.16</b> Repeating operations</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="project-organization.html"><a href="project-organization.html#references"><i class="fa fa-check"></i><b>10.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="troubleshooting.html"><a href="troubleshooting.html"><i class="fa fa-check"></i><b>11</b> Troubleshooting in R</a><ul>
<li class="chapter" data-level="11.1" data-path="troubleshooting.html"><a href="troubleshooting.html#how-to-interpret-error-messages"><i class="fa fa-check"></i><b>11.1</b> How to interpret error messages</a><ul>
<li class="chapter" data-level="11.1.1" data-path="troubleshooting.html"><a href="troubleshooting.html#locating-the-problematic-piece-of-code"><i class="fa fa-check"></i><b>11.1.1</b> Locating the problematic piece of code</a></li>
<li class="chapter" data-level="11.1.2" data-path="troubleshooting.html"><a href="troubleshooting.html#isolating-the-error"><i class="fa fa-check"></i><b>11.1.2</b> Isolating the error</a></li>
<li class="chapter" data-level="11.1.3" data-path="troubleshooting.html"><a href="troubleshooting.html#deciphering-error-messages"><i class="fa fa-check"></i><b>11.1.3</b> Deciphering error messages</a></li>
<li class="chapter" data-level="11.1.4" data-path="troubleshooting.html"><a href="troubleshooting.html#syntax-errors"><i class="fa fa-check"></i><b>11.1.4</b> Syntax errors</a></li>
<li class="chapter" data-level="11.1.5" data-path="troubleshooting.html"><a href="troubleshooting.html#errors-from-using-package-functions"><i class="fa fa-check"></i><b>11.1.5</b> Errors from using package functions</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="troubleshooting.html"><a href="troubleshooting.html#how-to-look-for-help"><i class="fa fa-check"></i><b>11.2</b> How to look for help</a><ul>
<li class="chapter" data-level="11.2.1" data-path="troubleshooting.html"><a href="troubleshooting.html#r-documentation"><i class="fa fa-check"></i><b>11.2.1</b> R documentation</a></li>
<li class="chapter" data-level="11.2.2" data-path="troubleshooting.html"><a href="troubleshooting.html#google"><i class="fa fa-check"></i><b>11.2.2</b> Google</a></li>
<li class="chapter" data-level="11.2.3" data-path="troubleshooting.html"><a href="troubleshooting.html#stackoverflow-et-al."><i class="fa fa-check"></i><b>11.2.3</b> StackOverflow et al.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="troubleshooting.html"><a href="troubleshooting.html#how-to-troubleshoot-a-loop"><i class="fa fa-check"></i><b>11.3</b> How to troubleshoot a loop</a></li>
<li class="chapter" data-level="11.4" data-path="troubleshooting.html"><a href="troubleshooting.html#how-to-troubleshoot-a-function"><i class="fa fa-check"></i><b>11.4</b> How to troubleshoot a function</a></li>
<li class="chapter" data-level="11.5" data-path="troubleshooting.html"><a href="troubleshooting.html#reproducible-examples"><i class="fa fa-check"></i><b>11.5</b> Reproducible examples</a></li>
<li class="chapter" data-level="11.6" data-path="troubleshooting.html"><a href="troubleshooting.html#the-rubber-duck"><i class="fa fa-check"></i><b>11.6</b> The rubber duck</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="renv.html"><a href="renv.html"><i class="fa fa-check"></i><b>12</b> Dependency Management in R</a><ul>
<li class="chapter" data-level="12.1" data-path="renv.html"><a href="renv.html#whats-the-need-for-dependency-management"><i class="fa fa-check"></i><b>12.1</b> What’s the need for dependency management?</a></li>
<li class="chapter" data-level="12.2" data-path="renv.html"><a href="renv.html#the-renv-package"><i class="fa fa-check"></i><b>12.2</b> The <code>renv</code> package</a><ul>
<li class="chapter" data-level="12.2.1" data-path="renv.html"><a href="renv.html#usage"><i class="fa fa-check"></i><b>12.2.1</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="project-organization.html"><a href="project-organization.html#references"><i class="fa fa-check"></i><b>12.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>13</b> Data Wrangling with tidyverse</a><ul>
<li class="chapter" data-level="13.1" data-path="tidyverse.html"><a href="tidyverse.html#welcome-to-the-tidyverse"><i class="fa fa-check"></i><b>13.1</b> Welcome to the tidyverse</a></li>
<li class="chapter" data-level="13.2" data-path="tidyverse.html"><a href="tidyverse.html#tidyverse-functions"><i class="fa fa-check"></i><b>13.2</b> Tidyverse functions</a><ul>
<li class="chapter" data-level="13.2.1" data-path="tidyverse.html"><a href="tidyverse.html#subsetting-columns"><i class="fa fa-check"></i><b>13.2.1</b> Subsetting columns</a></li>
<li class="chapter" data-level="13.2.2" data-path="tidyverse.html"><a href="tidyverse.html#subsetting-rows-with-logical-conditions"><i class="fa fa-check"></i><b>13.2.2</b> Subsetting rows with logical conditions</a></li>
<li class="chapter" data-level="13.2.3" data-path="tidyverse.html"><a href="tidyverse.html#concatenating-operations-with-pipes"><i class="fa fa-check"></i><b>13.2.3</b> Concatenating operations with pipes</a></li>
<li class="chapter" data-level="13.2.4" data-path="tidyverse.html"><a href="tidyverse.html#creating-new-columns"><i class="fa fa-check"></i><b>13.2.4</b> Creating new columns</a></li>
<li class="chapter" data-level="13.2.5" data-path="sql.html"><a href="sql.html#limiting-results"><i class="fa fa-check"></i><b>13.2.5</b> Limiting results</a></li>
<li class="chapter" data-level="13.2.6" data-path="tidyverse.html"><a href="tidyverse.html#tibbles"><i class="fa fa-check"></i><b>13.2.6</b> Tibbles</a></li>
<li class="chapter" data-level="13.2.7" data-path="tidyverse.html"><a href="tidyverse.html#joining-tables"><i class="fa fa-check"></i><b>13.2.7</b> Joining tables</a></li>
<li class="chapter" data-level="13.2.8" data-path="tidyverse.html"><a href="tidyverse.html#changing-the-order-of-columns"><i class="fa fa-check"></i><b>13.2.8</b> Changing the order of columns</a></li>
<li class="chapter" data-level="13.2.9" data-path="tidyverse.html"><a href="tidyverse.html#calculations-by-group"><i class="fa fa-check"></i><b>13.2.9</b> Calculations by group</a></li>
<li class="chapter" data-level="13.2.10" data-path="sql.html"><a href="sql.html#sorting-results"><i class="fa fa-check"></i><b>13.2.10</b> Sorting results</a></li>
<li class="chapter" data-level="13.2.11" data-path="tidyverse.html"><a href="tidyverse.html#extracting-columns-as-vectors"><i class="fa fa-check"></i><b>13.2.11</b> Extracting columns as vectors</a></li>
<li class="chapter" data-level="13.2.12" data-path="tidyverse.html"><a href="tidyverse.html#conditional-value-assignment"><i class="fa fa-check"></i><b>13.2.12</b> Conditional value assignment</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="tidyverse.html"><a href="tidyverse.html#style"><i class="fa fa-check"></i><b>13.3</b> Style</a></li>
<li class="chapter" data-level="13.4" data-path="project-organization.html"><a href="project-organization.html#references"><i class="fa fa-check"></i><b>13.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>14</b> Data Visualization with ggplot2</a><ul>
<li class="chapter" data-level="14.1" data-path="ggplot2.html"><a href="ggplot2.html#a-grammar-of-graphics"><i class="fa fa-check"></i><b>14.1</b> A Grammar of Graphics</a></li>
<li class="chapter" data-level="14.2" data-path="ggplot2.html"><a href="ggplot2.html#building-plots"><i class="fa fa-check"></i><b>14.2</b> Building plots</a><ul>
<li class="chapter" data-level="14.2.1" data-path="ggplot2.html"><a href="ggplot2.html#basic-scatterplot"><i class="fa fa-check"></i><b>14.2.1</b> Basic scatterplot</a></li>
<li class="chapter" data-level="14.2.2" data-path="ggplot2.html"><a href="ggplot2.html#basic-histogram"><i class="fa fa-check"></i><b>14.2.2</b> Basic histogram</a></li>
<li class="chapter" data-level="14.2.3" data-path="ggplot2.html"><a href="ggplot2.html#basic-density-plot"><i class="fa fa-check"></i><b>14.2.3</b> Basic density plot</a></li>
<li class="chapter" data-level="14.2.4" data-path="ggplot2.html"><a href="ggplot2.html#other-geom-functions"><i class="fa fa-check"></i><b>14.2.4</b> Other <code>geom</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="ggplot2.html"><a href="ggplot2.html#customizing-plots"><i class="fa fa-check"></i><b>14.3</b> Customizing plots</a><ul>
<li class="chapter" data-level="14.3.1" data-path="ggplot2.html"><a href="ggplot2.html#changing-axis-labels"><i class="fa fa-check"></i><b>14.3.1</b> Changing axis labels</a></li>
<li class="chapter" data-level="14.3.2" data-path="ggplot2.html"><a href="ggplot2.html#changing-colors"><i class="fa fa-check"></i><b>14.3.2</b> Changing colors</a></li>
<li class="chapter" data-level="14.3.3" data-path="ggplot2.html"><a href="ggplot2.html#modifying-legends"><i class="fa fa-check"></i><b>14.3.3</b> Modifying legends</a></li>
<li class="chapter" data-level="14.3.4" data-path="ggplot2.html"><a href="ggplot2.html#themes"><i class="fa fa-check"></i><b>14.3.4</b> Themes</a></li>
<li class="chapter" data-level="14.3.5" data-path="ggplot2.html"><a href="ggplot2.html#adding-transparency"><i class="fa fa-check"></i><b>14.3.5</b> Adding transparency</a></li>
<li class="chapter" data-level="14.3.6" data-path="ggplot2.html"><a href="ggplot2.html#overlaying-plots-with-different-aesthetics"><i class="fa fa-check"></i><b>14.3.6</b> Overlaying plots with different aesthetics</a></li>
<li class="chapter" data-level="14.3.7" data-path="ggplot2.html"><a href="ggplot2.html#modifying-symbol-appearance"><i class="fa fa-check"></i><b>14.3.7</b> Modifying symbol appearance</a></li>
<li class="chapter" data-level="14.3.8" data-path="ggplot2.html"><a href="ggplot2.html#fill-vs.-color"><i class="fa fa-check"></i><b>14.3.8</b> Fill vs. color</a></li>
<li class="chapter" data-level="14.3.9" data-path="ggplot2.html"><a href="ggplot2.html#modifying-axis-values"><i class="fa fa-check"></i><b>14.3.9</b> Modifying axis values</a></li>
<li class="chapter" data-level="14.3.10" data-path="ggplot2.html"><a href="ggplot2.html#adding-an-extra-dimension-with-facets"><i class="fa fa-check"></i><b>14.3.10</b> Adding an extra dimension with facets</a></li>
<li class="chapter" data-level="14.3.11" data-path="ggplot2.html"><a href="ggplot2.html#error-bars"><i class="fa fa-check"></i><b>14.3.11</b> Error bars</a></li>
<li class="chapter" data-level="14.3.12" data-path="ggplot2.html"><a href="ggplot2.html#plot-model-predictions-with-uncertainty"><i class="fa fa-check"></i><b>14.3.12</b> Plot model predictions with uncertainty</a></li>
<li class="chapter" data-level="14.3.13" data-path="ggplot2.html"><a href="ggplot2.html#plot-paths-of-ordered-observations"><i class="fa fa-check"></i><b>14.3.13</b> Plot paths of ordered observations</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="ggplot2.html"><a href="ggplot2.html#colorblind-friendly-plots-with-viridis"><i class="fa fa-check"></i><b>14.4</b> Colorblind-friendly plots with <code>viridis</code></a></li>
<li class="chapter" data-level="14.5" data-path="ggplot2.html"><a href="ggplot2.html#arranging-multiple-plots-together-with-patchwork"><i class="fa fa-check"></i><b>14.5</b> Arranging multiple plots together with <code>patchwork</code></a></li>
<li class="chapter" data-level="14.6" data-path="ggplot2.html"><a href="ggplot2.html#saving-plots"><i class="fa fa-check"></i><b>14.6</b> Saving plots</a></li>
<li class="chapter" data-level="14.7" data-path="project-organization.html"><a href="project-organization.html#references"><i class="fa fa-check"></i><b>14.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="geospatial.html"><a href="geospatial.html"><i class="fa fa-check"></i><b>15</b> Introduction to Geospatial Data in R</a></li>
<li class="chapter" data-level="16" data-path="problem-decomposition.html"><a href="problem-decomposition.html"><i class="fa fa-check"></i><b>16</b> Problem Decomposition</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational Tools for Reproducible Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2" class="section level1">
<h1><span class="header-section-number">Chapter 14</span> Data Visualization with ggplot2</h1>
<p>Data visualization and storytelling is one of the most important parts of the
scientific process, and arguably the most fun. In this Chapter, we are going to
see how to make beautiful, elegant plots using the core <code>tidyverse</code> package
<code>ggplot2</code>.</p>
<div class="figure" style="text-align: center"><span id="fig:gg0"></span>
<img src="img/ggplot2_masterpiece.png" alt="Artwork by Allison Horst" width="80%" />
<p class="caption">
Figure 14.1: Artwork by Allison Horst
</p>
</div>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="ggplot2.html#cb431-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<p>We are going to practice using the dragon dataset again, so let’s load it in:</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="ggplot2.html#cb432-1"></a><span class="kw">library</span>(DBI)</span>
<span id="cb432-2"><a href="ggplot2.html#cb432-2"></a></span>
<span id="cb432-3"><a href="ggplot2.html#cb432-3"></a>dragons_db &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(RSQLite<span class="op">::</span><span class="kw">SQLite</span>(), <span class="st">&quot;../../Course Material/Data/dragons/dragons.db&quot;</span>)</span>
<span id="cb432-4"><a href="ggplot2.html#cb432-4"></a></span>
<span id="cb432-5"><a href="ggplot2.html#cb432-5"></a>dragons &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(dragons_db, <span class="st">&quot;SELECT * FROM dragons;&quot;</span>)</span>
<span id="cb432-6"><a href="ggplot2.html#cb432-6"></a>capture_sites &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(dragons_db, <span class="st">&quot;SELECT * FROM capture_sites;&quot;</span>)</span>
<span id="cb432-7"><a href="ggplot2.html#cb432-7"></a>captures &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(dragons_db, <span class="st">&quot;SELECT * FROM captures;&quot;</span>)</span>
<span id="cb432-8"><a href="ggplot2.html#cb432-8"></a>morphometrics &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(dragons_db, <span class="st">&quot;SELECT * FROM morphometrics;&quot;</span>)</span>
<span id="cb432-9"><a href="ggplot2.html#cb432-9"></a>diet &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(dragons_db, <span class="st">&quot;SELECT * FROM diet;&quot;</span>)</span>
<span id="cb432-10"><a href="ggplot2.html#cb432-10"></a>tags &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(dragons_db, <span class="st">&quot;SELECT * FROM tags;&quot;</span>)</span>
<span id="cb432-11"><a href="ggplot2.html#cb432-11"></a>deployments &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(dragons_db, <span class="st">&quot;SELECT * FROM deployments;&quot;</span>)</span>
<span id="cb432-12"><a href="ggplot2.html#cb432-12"></a>telemetry &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(dragons_db, <span class="st">&quot;SELECT * FROM gps_data;&quot;</span>)</span></code></pre></div>
<div id="a-grammar-of-graphics" class="section level2">
<h2><span class="header-section-number">14.1</span> A Grammar of Graphics</h2>
<p>What makes data visualization in <code>ggplot2</code> different from data visualization
using base R functions? Instead of having to manually combine raw elements like
points and lines to produce the figure you want, <code>ggplot2</code> allows you to use a
more structured approach so that a handful of commands will produce the plot you
have in mind with minimal hassle.</p>
<p>The logic of <code>ggplot</code> follows the “Grammar of Graphics” framework, which was
first introduced in <a href="https://www.springer.com/in/book/9780387245447">a book by Leland Wilkinson</a>. This framework
concisely describes the different components of a graphic. At a minimum, a plot
is composed by data, aesthetics, and geometries:</p>
<ul>
<li>Data: this is the data you want to represent in your plot;</li>
<li>Aesthetics: these are the variables that are represented on the plot (e.g.,
what goes on the axes, or what is encoded with different symbols and colors);</li>
<li>Geometries: these are the actual symbols that appear on the plot (points,
lines, etc.)</li>
</ul>
<p>On top of these fundamental components, there can be additional elements for
customization.</p>
<p>Another major difference between <code>ggplot2</code> and plots in base R is that <code>ggplot2</code>
works like a <em>declarative</em> language. Declarative means that the code to make the
plot is evaluated and interpreted all at once, not one line at a time like in
base R, which by contrast is an <em>imperative</em> language. We are used to paying
close attention to the order in which we run code in R, because if we run
commands in the wrong order things won’t work, but as we’ll see the order in
which we specify features of our plot is not as rigid in <code>ggplot2</code>.</p>
</div>
<div id="building-plots" class="section level2">
<h2><span class="header-section-number">14.2</span> Building plots</h2>
<p><code>ggplot</code> works in layers. Each layer specifies one or more components of the
plot, and layers can be added to progressively customize the final result. At a
minimum, a plot has to contain layers for the three fundamental
components that we’ve seen above: data, aesthetics, and geometries. Everything
else is optional. Layers are added using a <code>+</code> sign.</p>
<div id="basic-scatterplot" class="section level3">
<h3><span class="header-section-number">14.2.1</span> Basic scatterplot</h3>
<p>Let’s say that we want to explore the correlation between total body length and
wingspan in dragons. We may want to look at that using a scatterplot. This is
how to build one in <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="ggplot2.html#cb433-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> morphometrics, </span>
<span id="cb433-2"><a href="ggplot2.html#cb433-2"></a>       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm)) <span class="op">+</span></span>
<span id="cb433-3"><a href="ggplot2.html#cb433-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg3-1.png" width="672" /></p>
<p>Let’s break down the syntax of what I just wrote. First, we start with the
function <code>ggplot</code>. This function takes as input 1. the data that we want to plot
and 2. the aesthetics for the plot. At a minimum, these include the variables
that we want to plot on the two axes. Here, I specified that I want to plot the
data frame called <code>morphometrics</code> and that I want to plot total body length on
the x axis and wingspan on the y axis. Then there’s a <code>+</code> sign, which means that
we’re adding a layer. The next layer describes the geometry we want to plot. A
scatterplot is made of points, so the function to use is <code>geom_point</code>. So
essentially you could read that whole code as, “make a scatterplot with the
morphometrics table where total body length is on the x axis and wingspan is on
the y axis.”</p>
<p>Note that, if you look at the help file for <code>geom_point</code> or any other <code>geom_</code>
function, you’ll see that the first two arguments are <code>mapping</code> and <code>data</code>.
These are the same as the ones we specified in <code>ggplot</code>. What’s up with that?
The <code>data</code> and <code>mapping</code> options that we specify in <code>ggplot</code> are global plot
settings that will be implicitly assumed for every layer downstream. If we don’t
specify anything for these two arguments in the <code>geom_</code> function, the geometries
will inherit the global plot settings. But it’s possible to override the global
plot settings by specifying different ones in a certain layer, for example if
we want to overlay two different datasets.</p>
</div>
<div id="basic-histogram" class="section level3">
<h3><span class="header-section-number">14.2.2</span> Basic histogram</h3>
<p>What if we wanted to look at the distribution of total body length instead? We
may want to use a histogram for that:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="ggplot2.html#cb434-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> morphometrics, </span>
<span id="cb434-2"><a href="ggplot2.html#cb434-2"></a>       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm)) <span class="op">+</span></span>
<span id="cb434-3"><a href="ggplot2.html#cb434-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="reproducible-science_files/figure-html/gg4-1.png" width="672" /></p>
<p>In this case we only have one aesthetic, because the y axis on a histogram is
the bin frequency (by default, <code>ggplot2</code> shows the absolute frequency). We can
choose other options within <code>geom_histogram</code>, such as changing the number of
bins:</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="ggplot2.html#cb436-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> morphometrics, </span>
<span id="cb436-2"><a href="ggplot2.html#cb436-2"></a>       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm)) <span class="op">+</span></span>
<span id="cb436-3"><a href="ggplot2.html#cb436-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">100</span>)</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg5-1.png" width="672" /></p>
</div>
<div id="basic-density-plot" class="section level3">
<h3><span class="header-section-number">14.2.3</span> Basic density plot</h3>
<p>Perhaps a better way to visualize the distribution of a variable is to use a
density plot rather than a histogram.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="ggplot2.html#cb437-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> morphometrics, </span>
<span id="cb437-2"><a href="ggplot2.html#cb437-2"></a>       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm)) <span class="op">+</span></span>
<span id="cb437-3"><a href="ggplot2.html#cb437-3"></a><span class="st">  </span><span class="kw">geom_density</span>()</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg5b-1.png" width="672" /></p>
</div>
<div id="other-geom-functions" class="section level3">
<h3><span class="header-section-number">14.2.4</span> Other <code>geom</code> functions</h3>
<p>The ones above are just four common examples of functions in the <code>geom</code> family,
but there are many others that you may find yourself using (and we’ll see some
of these in action throughout the rest of this Chapter and in class):</p>
<ul>
<li><code>geom_line</code> for lines connecting observations based on their value (useful for
time series plots and regression lines);</li>
<li><code>geom_path</code> for lines connecting observations based on the order they appear
in (useful for movement data);</li>
<li><code>geom_ribbon</code> for shaded envelopes around lines (useful for representing
confidence intervals);</li>
<li><code>geom_hline</code> and <code>geom_vline</code>, for horizontal and vertical intercepts,
respectively;</li>
<li><code>geom_boxplot</code> and <code>geom_violin</code> for distributions of continuous variables;</li>
<li><code>geom_pointrange</code> for point estimates with uncertainty ranges;</li>
<li>and many many more…</li>
</ul>
</div>
</div>
<div id="customizing-plots" class="section level2">
<h2><span class="header-section-number">14.3</span> Customizing plots</h2>
<p>Now that we got the gist of how to build a basic plot in <code>ggplot2</code>, let’s start
to learn how to make them pretty.</p>
<div id="changing-axis-labels" class="section level3">
<h3><span class="header-section-number">14.3.1</span> Changing axis labels</h3>
<p>Let’s go back to our scatterplot and fix some
details. First, let’s change the axis labels. There are several ways to do this;
one of them is this:</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="ggplot2.html#cb438-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> morphometrics, </span>
<span id="cb438-2"><a href="ggplot2.html#cb438-2"></a>       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm)) <span class="op">+</span></span>
<span id="cb438-3"><a href="ggplot2.html#cb438-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb438-4"><a href="ggplot2.html#cb438-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>)</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg6-1.png" width="672" /></p>
<p>An alternative way is:</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="ggplot2.html#cb439-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> morphometrics, </span>
<span id="cb439-2"><a href="ggplot2.html#cb439-2"></a>       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm)) <span class="op">+</span></span>
<span id="cb439-3"><a href="ggplot2.html#cb439-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb439-4"><a href="ggplot2.html#cb439-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Total body length (cm)&quot;</span>) <span class="op">+</span></span>
<span id="cb439-5"><a href="ggplot2.html#cb439-5"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Wingspan (cm)&quot;</span>)</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg7-1.png" width="672" /></p>
</div>
<div id="changing-colors" class="section level3">
<h3><span class="header-section-number">14.3.2</span> Changing colors</h3>
<p>See that cluster of points in the bottom-left of the scatterplot? It seems like
there’s a lot less variation in terms of body measurements in that cluster
compared to the larger cloud on the right. Could that be because of an age
effect? Perhaps young dragons are more consistent in their measurements, and as
they reach adulthood their body size varies much more between individuals.
Let’s try to get a clue to verify this hypothesis by coloring the dots on the
scatterplot based on age. We are going to use some of the tools we learned in
Chapter <a href="tidyverse.html#tidyverse">13</a> to associate age information from the dragons table
to the morphometrics table:</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="ggplot2.html#cb440-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb440-2"><a href="ggplot2.html#cb440-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb440-3"><a href="ggplot2.html#cb440-3"></a><span class="st">  </span><span class="co"># note that I am feeding the results of the pipe directly into ggplot:</span></span>
<span id="cb440-4"><a href="ggplot2.html#cb440-4"></a><span class="st">  </span><span class="co"># whatever comes out of that pipe is used as the data argument for the plot</span></span>
<span id="cb440-5"><a href="ggplot2.html#cb440-5"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb440-6"><a href="ggplot2.html#cb440-6"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb440-7"><a href="ggplot2.html#cb440-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>)</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg8-1.png" width="672" /></p>
</div>
<div id="modifying-legends" class="section level3">
<h3><span class="header-section-number">14.3.3</span> Modifying legends</h3>
<p>Looks like our hypothesis was correct: that cluster of points includes
measurements for juvenile dragons. Let’s make that legend a little prettier:</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="ggplot2.html#cb441-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb441-2"><a href="ggplot2.html#cb441-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb441-3"><a href="ggplot2.html#cb441-3"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb441-4"><a href="ggplot2.html#cb441-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb441-5"><a href="ggplot2.html#cb441-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>)</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg9-1.png" width="672" /></p>
<p>Besides changing the title of the legend, we can also change the labels on each
of the categories that appear in it. For example, if we wanted to add age
ranges to correspond to each age class:</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="ggplot2.html#cb442-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb442-2"><a href="ggplot2.html#cb442-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb442-3"><a href="ggplot2.html#cb442-3"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb442-4"><a href="ggplot2.html#cb442-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb442-5"><a href="ggplot2.html#cb442-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb442-6"><a href="ggplot2.html#cb442-6"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Adult (&gt; 3 years)&quot;</span>,</span>
<span id="cb442-7"><a href="ggplot2.html#cb442-7"></a>                                 <span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb442-8"><a href="ggplot2.html#cb442-8"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>))</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg10-1.png" width="672" /></p>
<p>What if we want to reorder legend items so that they appear in order of age?
That is not something that we can do within the plot itself, it’s a change that
needs to be done in the data before we plot. We need to change the order of the
levels in the factor <code>age_class</code>. Once that’s done, we need to remember to also
change the order of the labels to reflect the new order:</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="ggplot2.html#cb443-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb443-2"><a href="ggplot2.html#cb443-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb443-3"><a href="ggplot2.html#cb443-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb443-4"><a href="ggplot2.html#cb443-4"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb443-5"><a href="ggplot2.html#cb443-5"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb443-6"><a href="ggplot2.html#cb443-6"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb443-7"><a href="ggplot2.html#cb443-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb443-8"><a href="ggplot2.html#cb443-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb443-9"><a href="ggplot2.html#cb443-9"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb443-10"><a href="ggplot2.html#cb443-10"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb443-11"><a href="ggplot2.html#cb443-11"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg11-1.png" width="672" /></p>
<p>We can also change the position of the legend:</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="ggplot2.html#cb444-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb444-2"><a href="ggplot2.html#cb444-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb444-3"><a href="ggplot2.html#cb444-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb444-4"><a href="ggplot2.html#cb444-4"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb444-5"><a href="ggplot2.html#cb444-5"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb444-6"><a href="ggplot2.html#cb444-6"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb444-7"><a href="ggplot2.html#cb444-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb444-8"><a href="ggplot2.html#cb444-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb444-9"><a href="ggplot2.html#cb444-9"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb444-10"><a href="ggplot2.html#cb444-10"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb444-11"><a href="ggplot2.html#cb444-11"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb444-12"><a href="ggplot2.html#cb444-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg11b-1.png" width="672" /></p>
</div>
<div id="themes" class="section level3">
<h3><span class="header-section-number">14.3.4</span> Themes</h3>
<p>The <code>theme</code> function that we just used to move the legend to the bottom can do
so much more than just that! It has arguments that allow you to customize the
appearance of your plot in pretty much any way you want. Things like the plot
title and subtitle, the labels that appear on the axes (and you can have two
y axis, one on the right and one on the left, or two x axis, one on the top and
one on the bottom), the numbers or words that appear on axis ticks as well as
their size and orientation, the length of the ticks themselves, legend size,
spacing, alignment, the look of the background of the plot…</p>
<p>You can create your own theme by saving it as an object and then adding it to
a plot as a new layer:</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="ggplot2.html#cb445-1"></a><span class="co"># This theme adds a gray box around the legend and </span></span>
<span id="cb445-2"><a href="ggplot2.html#cb445-2"></a><span class="co"># alternates the size of the lines in the background grid</span></span>
<span id="cb445-3"><a href="ggplot2.html#cb445-3"></a>my_theme &lt;-<span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;gray90&quot;</span>,</span>
<span id="cb445-4"><a href="ggplot2.html#cb445-4"></a>                                                   <span class="dt">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb445-5"><a href="ggplot2.html#cb445-5"></a>                                                   <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>,</span>
<span id="cb445-6"><a href="ggplot2.html#cb445-6"></a>                                                   <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb445-7"><a href="ggplot2.html#cb445-7"></a>                  <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb445-8"><a href="ggplot2.html#cb445-8"></a>                                                  <span class="dt">size =</span> <span class="fl">1.5</span>))</span>
<span id="cb445-9"><a href="ggplot2.html#cb445-9"></a></span>
<span id="cb445-10"><a href="ggplot2.html#cb445-10"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb445-11"><a href="ggplot2.html#cb445-11"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb445-12"><a href="ggplot2.html#cb445-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb445-13"><a href="ggplot2.html#cb445-13"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb445-14"><a href="ggplot2.html#cb445-14"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb445-15"><a href="ggplot2.html#cb445-15"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb445-16"><a href="ggplot2.html#cb445-16"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb445-17"><a href="ggplot2.html#cb445-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb445-18"><a href="ggplot2.html#cb445-18"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb445-19"><a href="ggplot2.html#cb445-19"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb445-20"><a href="ggplot2.html#cb445-20"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb445-21"><a href="ggplot2.html#cb445-21"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span></span>
<span id="cb445-22"><a href="ggplot2.html#cb445-22"></a><span class="st">  </span>my_theme</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg12-1.png" width="672" /></p>
<p>Ugly. I know.</p>
<p>If you’re not a graphic designer and your plots look as ugly as mine when you
manipulate the theme yourself, <code>ggplot2</code> also offers a variety of pre-set themes.
For example, here is the “minimal” theme:</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="ggplot2.html#cb446-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb446-2"><a href="ggplot2.html#cb446-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb446-3"><a href="ggplot2.html#cb446-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb446-4"><a href="ggplot2.html#cb446-4"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb446-5"><a href="ggplot2.html#cb446-5"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb446-6"><a href="ggplot2.html#cb446-6"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb446-7"><a href="ggplot2.html#cb446-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb446-8"><a href="ggplot2.html#cb446-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb446-9"><a href="ggplot2.html#cb446-9"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb446-10"><a href="ggplot2.html#cb446-10"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb446-11"><a href="ggplot2.html#cb446-11"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb446-12"><a href="ggplot2.html#cb446-12"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb446-13"><a href="ggplot2.html#cb446-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg13-1.png" width="672" /></p>
<p>Here is the “black and white” theme:</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="ggplot2.html#cb447-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb447-2"><a href="ggplot2.html#cb447-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb447-3"><a href="ggplot2.html#cb447-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb447-4"><a href="ggplot2.html#cb447-4"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb447-5"><a href="ggplot2.html#cb447-5"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb447-6"><a href="ggplot2.html#cb447-6"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb447-7"><a href="ggplot2.html#cb447-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb447-8"><a href="ggplot2.html#cb447-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb447-9"><a href="ggplot2.html#cb447-9"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb447-10"><a href="ggplot2.html#cb447-10"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb447-11"><a href="ggplot2.html#cb447-11"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb447-12"><a href="ggplot2.html#cb447-12"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb447-13"><a href="ggplot2.html#cb447-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg14-1.png" width="672" /></p>
<p>Here is the “void” theme:</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="ggplot2.html#cb448-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb448-2"><a href="ggplot2.html#cb448-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb448-3"><a href="ggplot2.html#cb448-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb448-4"><a href="ggplot2.html#cb448-4"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb448-5"><a href="ggplot2.html#cb448-5"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb448-6"><a href="ggplot2.html#cb448-6"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb448-7"><a href="ggplot2.html#cb448-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb448-8"><a href="ggplot2.html#cb448-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb448-9"><a href="ggplot2.html#cb448-9"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb448-10"><a href="ggplot2.html#cb448-10"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb448-11"><a href="ggplot2.html#cb448-11"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb448-12"><a href="ggplot2.html#cb448-12"></a><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb448-13"><a href="ggplot2.html#cb448-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg15-1.png" width="672" /></p>
<p>If you use a pre-set theme, make sure you add that layer before you add any
other tweaks using <code>theme</code>, because if you add <code>theme</code> first, the pre-set theme
will override whatever settings you specified in <code>theme</code>. For instance, if I put
<code>theme_void</code> at the end in the previous example, the legend does not get moved
to the bottom:</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="ggplot2.html#cb449-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb449-2"><a href="ggplot2.html#cb449-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb449-3"><a href="ggplot2.html#cb449-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb449-4"><a href="ggplot2.html#cb449-4"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb449-5"><a href="ggplot2.html#cb449-5"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb449-6"><a href="ggplot2.html#cb449-6"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb449-7"><a href="ggplot2.html#cb449-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb449-8"><a href="ggplot2.html#cb449-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb449-9"><a href="ggplot2.html#cb449-9"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb449-10"><a href="ggplot2.html#cb449-10"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb449-11"><a href="ggplot2.html#cb449-11"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb449-12"><a href="ggplot2.html#cb449-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span></span>
<span id="cb449-13"><a href="ggplot2.html#cb449-13"></a><span class="st">  </span><span class="kw">theme_void</span>() </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg16-1.png" width="672" /></p>
</div>
<div id="adding-transparency" class="section level3">
<h3><span class="header-section-number">14.3.5</span> Adding transparency</h3>
<p>We could decide that we want to make the points transparent on this plot so
that we can actually get a better feel for the amount of data points within
very clumpy clusters. We can do that by adding the argument <code>alpha</code> in our
geometry layer:</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="ggplot2.html#cb450-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb450-2"><a href="ggplot2.html#cb450-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb450-3"><a href="ggplot2.html#cb450-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb450-4"><a href="ggplot2.html#cb450-4"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb450-5"><a href="ggplot2.html#cb450-5"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb450-6"><a href="ggplot2.html#cb450-6"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb450-7"><a href="ggplot2.html#cb450-7"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb450-8"><a href="ggplot2.html#cb450-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb450-9"><a href="ggplot2.html#cb450-9"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb450-10"><a href="ggplot2.html#cb450-10"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb450-11"><a href="ggplot2.html#cb450-11"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb450-12"><a href="ggplot2.html#cb450-12"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb450-13"><a href="ggplot2.html#cb450-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg16b-1.png" width="672" /></p>
</div>
<div id="overlaying-plots-with-different-aesthetics" class="section level3">
<h3><span class="header-section-number">14.3.6</span> Overlaying plots with different aesthetics</h3>
<p>From the plot we made, it seems clear that there is a correlation between the
total body length of a dragon and its wingspan. We could actually model that
correlation using linear regression. And then we may want to overlay the
regression line to the raw data on our existing plot. Let’s see how to do just
that:</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="ggplot2.html#cb451-1"></a><span class="co"># Fit linear regression</span></span>
<span id="cb451-2"><a href="ggplot2.html#cb451-2"></a>(reg &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> wingspan_cm <span class="op">~</span><span class="st"> </span>total_body_length_cm, </span>
<span id="cb451-3"><a href="ggplot2.html#cb451-3"></a>          <span class="dt">data =</span> morphometrics))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = wingspan_cm ~ total_body_length_cm, data = morphometrics)
## 
## Coefficients:
##          (Intercept)  total_body_length_cm  
##             445.2124                0.8525</code></pre>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="ggplot2.html#cb453-1"></a><span class="co"># Let&#39;s grab the value of the intercept and slope</span></span>
<span id="cb453-2"><a href="ggplot2.html#cb453-2"></a>coefs &lt;-<span class="st"> </span>reg<span class="op">$</span>coefficients</span>
<span id="cb453-3"><a href="ggplot2.html#cb453-3"></a></span>
<span id="cb453-4"><a href="ggplot2.html#cb453-4"></a><span class="co"># Now we can plot</span></span>
<span id="cb453-5"><a href="ggplot2.html#cb453-5"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb453-6"><a href="ggplot2.html#cb453-6"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb453-7"><a href="ggplot2.html#cb453-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb453-8"><a href="ggplot2.html#cb453-8"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb453-9"><a href="ggplot2.html#cb453-9"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb453-10"><a href="ggplot2.html#cb453-10"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb453-11"><a href="ggplot2.html#cb453-11"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb453-12"><a href="ggplot2.html#cb453-12"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="kw">aes</span>(<span class="dt">slope =</span> coefs[<span class="dv">2</span>], <span class="dt">intercept =</span> coefs[<span class="dv">1</span>])) <span class="op">+</span><span class="st"> </span></span>
<span id="cb453-13"><a href="ggplot2.html#cb453-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb453-14"><a href="ggplot2.html#cb453-14"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb453-15"><a href="ggplot2.html#cb453-15"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb453-16"><a href="ggplot2.html#cb453-16"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb453-17"><a href="ggplot2.html#cb453-17"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb453-18"><a href="ggplot2.html#cb453-18"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg17-1.png" width="672" /></p>
<p>I added a new layer to the plot with <code>geom_abline</code>. Instead of the global
aesthetics (the ones I specify at the beginning in <code>ggplot</code>), I need to provide
a slope and an intercept. This is what I meant when I said that sometimes a
certain geometry layer can use different aesthetics than the global ones.
By specifying different aesthetics in that geometry layer, the global aesthetics
get overridden for that layer only.</p>
</div>
<div id="modifying-symbol-appearance" class="section level3">
<h3><span class="header-section-number">14.3.7</span> Modifying symbol appearance</h3>
<p>We can now play around with size, color, and line type of our regression line:</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="ggplot2.html#cb454-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb454-2"><a href="ggplot2.html#cb454-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb454-3"><a href="ggplot2.html#cb454-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb454-4"><a href="ggplot2.html#cb454-4"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb454-5"><a href="ggplot2.html#cb454-5"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb454-6"><a href="ggplot2.html#cb454-6"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb454-7"><a href="ggplot2.html#cb454-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb454-8"><a href="ggplot2.html#cb454-8"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="kw">aes</span>(<span class="dt">slope =</span> coefs[<span class="dv">2</span>], <span class="dt">intercept =</span> coefs[<span class="dv">1</span>]), </span>
<span id="cb454-9"><a href="ggplot2.html#cb454-9"></a>              <span class="dt">size =</span> <span class="dv">2</span>,</span>
<span id="cb454-10"><a href="ggplot2.html#cb454-10"></a>              <span class="dt">color =</span> <span class="st">&quot;gray70&quot;</span>,</span>
<span id="cb454-11"><a href="ggplot2.html#cb454-11"></a>              <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb454-12"><a href="ggplot2.html#cb454-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb454-13"><a href="ggplot2.html#cb454-13"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb454-14"><a href="ggplot2.html#cb454-14"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb454-15"><a href="ggplot2.html#cb454-15"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb454-16"><a href="ggplot2.html#cb454-16"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb454-17"><a href="ggplot2.html#cb454-17"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg18-1.png" width="672" /></p>
<p>We can also change the symbols for the point data:</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="ggplot2.html#cb455-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb455-2"><a href="ggplot2.html#cb455-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb455-3"><a href="ggplot2.html#cb455-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb455-4"><a href="ggplot2.html#cb455-4"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb455-5"><a href="ggplot2.html#cb455-5"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb455-6"><a href="ggplot2.html#cb455-6"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb455-7"><a href="ggplot2.html#cb455-7"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">shape =</span> <span class="dv">8</span>) <span class="op">+</span></span>
<span id="cb455-8"><a href="ggplot2.html#cb455-8"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="kw">aes</span>(<span class="dt">slope =</span> coefs[<span class="dv">2</span>], <span class="dt">intercept =</span> coefs[<span class="dv">1</span>]), </span>
<span id="cb455-9"><a href="ggplot2.html#cb455-9"></a>              <span class="dt">size =</span> <span class="dv">2</span>,</span>
<span id="cb455-10"><a href="ggplot2.html#cb455-10"></a>              <span class="dt">color =</span> <span class="st">&quot;gray70&quot;</span>,</span>
<span id="cb455-11"><a href="ggplot2.html#cb455-11"></a>              <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb455-12"><a href="ggplot2.html#cb455-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb455-13"><a href="ggplot2.html#cb455-13"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb455-14"><a href="ggplot2.html#cb455-14"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb455-15"><a href="ggplot2.html#cb455-15"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb455-16"><a href="ggplot2.html#cb455-16"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb455-17"><a href="ggplot2.html#cb455-17"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg19-1.png" width="672" /></p>
</div>
<div id="fill-vs.-color" class="section level3">
<h3><span class="header-section-number">14.3.8</span> Fill vs. color</h3>
<p>Shapes that are one-dimensional (points and lines) are colored using the
argument <code>color</code> in <code>ggplot2</code>. Shapes that are two-dimensional (polygons,
bars in a barplot, ecc.) are colored inside using the argument <code>fill</code>, and
around the border with <code>color</code>. Let’s make an example with some boxplots, which
are two-dimensional. This is what happens if we use <code>color</code> instead of <code>fill</code>:</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="ggplot2.html#cb456-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb456-2"><a href="ggplot2.html#cb456-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb456-3"><a href="ggplot2.html#cb456-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb456-4"><a href="ggplot2.html#cb456-4"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb456-5"><a href="ggplot2.html#cb456-5"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb456-6"><a href="ggplot2.html#cb456-6"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb456-7"><a href="ggplot2.html#cb456-7"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb456-8"><a href="ggplot2.html#cb456-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot; &quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb456-9"><a href="ggplot2.html#cb456-9"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb456-10"><a href="ggplot2.html#cb456-10"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb456-11"><a href="ggplot2.html#cb456-11"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb456-12"><a href="ggplot2.html#cb456-12"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb456-13"><a href="ggplot2.html#cb456-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg20-1.png" width="672" /></p>
<p>If we use fill, the border of the boxplots will be black and the inside will
be colored (note that we need to change it in three places: the global
aesthetics, the legend title in <code>labs</code>, and the name of the function to add
legend labels becomes <code>scale_fill_discrete</code>):</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="ggplot2.html#cb457-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb457-2"><a href="ggplot2.html#cb457-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb457-3"><a href="ggplot2.html#cb457-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb457-4"><a href="ggplot2.html#cb457-4"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb457-5"><a href="ggplot2.html#cb457-5"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb457-6"><a href="ggplot2.html#cb457-6"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> wingspan_cm, <span class="dt">fill =</span> age_class)) <span class="op">+</span></span>
<span id="cb457-7"><a href="ggplot2.html#cb457-7"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb457-8"><a href="ggplot2.html#cb457-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot; &quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb457-9"><a href="ggplot2.html#cb457-9"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb457-10"><a href="ggplot2.html#cb457-10"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb457-11"><a href="ggplot2.html#cb457-11"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb457-12"><a href="ggplot2.html#cb457-12"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb457-13"><a href="ggplot2.html#cb457-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg21-1.png" width="672" /></p>
</div>
<div id="modifying-axis-values" class="section level3">
<h3><span class="header-section-number">14.3.9</span> Modifying axis values</h3>
<p>The values on the x axis don’t mean anything in this case because this is a
boxplot. Let’s get rid of them in <code>theme</code>:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="ggplot2.html#cb458-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb458-2"><a href="ggplot2.html#cb458-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb458-3"><a href="ggplot2.html#cb458-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb458-4"><a href="ggplot2.html#cb458-4"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb458-5"><a href="ggplot2.html#cb458-5"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb458-6"><a href="ggplot2.html#cb458-6"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> wingspan_cm, <span class="dt">fill =</span> age_class)) <span class="op">+</span></span>
<span id="cb458-7"><a href="ggplot2.html#cb458-7"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb458-8"><a href="ggplot2.html#cb458-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot; &quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb458-9"><a href="ggplot2.html#cb458-9"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb458-10"><a href="ggplot2.html#cb458-10"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb458-11"><a href="ggplot2.html#cb458-11"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb458-12"><a href="ggplot2.html#cb458-12"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb458-13"><a href="ggplot2.html#cb458-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb458-14"><a href="ggplot2.html#cb458-14"></a>        <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>()) </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg22-1.png" width="672" /></p>
</div>
<div id="adding-an-extra-dimension-with-facets" class="section level3">
<h3><span class="header-section-number">14.3.10</span> Adding an extra dimension with facets</h3>
<p>Dragon size might also depend on species. What if we wanted to look at the
correlation between wingspan and total body length broken down by species as
well as age class? That means we need to add another dimension to our scatterplot
which is already showing 3: the x axis, the y axis, and the different colors.
Facets expand the amount of information we can convey in a plot. Let’s see how
they work:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="ggplot2.html#cb459-1"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb459-2"><a href="ggplot2.html#cb459-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb459-3"><a href="ggplot2.html#cb459-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb459-4"><a href="ggplot2.html#cb459-4"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb459-5"><a href="ggplot2.html#cb459-5"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb459-6"><a href="ggplot2.html#cb459-6"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb459-7"><a href="ggplot2.html#cb459-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb459-8"><a href="ggplot2.html#cb459-8"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>species) <span class="op">+</span></span>
<span id="cb459-9"><a href="ggplot2.html#cb459-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb459-10"><a href="ggplot2.html#cb459-10"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb459-11"><a href="ggplot2.html#cb459-11"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb459-12"><a href="ggplot2.html#cb459-12"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb459-13"><a href="ggplot2.html#cb459-13"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb459-14"><a href="ggplot2.html#cb459-14"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg23b-1.png" width="672" /></p>
<p>The function I used to break down the plot into facets is <code>facet_wrap</code>. This
function takes as input a one-sided formula: <code>~ variable/s</code>. What goes on the
right hand side of the formula is the categorical variable based on which we
want to break down the plot. These can also be multiple categorical variables,
in which case there will be as many facets as the possible level combinations.</p>
<p>The labels that appear on the facets are verbatim the factor levels that
appear in the data frame. If we weren’t happy with them (say, they are too long,
or they are all lowercase and we want title case) we could change them. Let’s
try to replace the full species names with just the initials. We need to define
a labeller, which is a vector associating each label the way it appears in the
current plot with the label that we want instead:</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="ggplot2.html#cb460-1"></a>species_labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Hebridean Black&quot;</span> =<span class="st"> &quot;HB&quot;</span>,</span>
<span id="cb460-2"><a href="ggplot2.html#cb460-2"></a>                    <span class="st">&quot;Romanian Longhorn&quot;</span> =<span class="st"> &quot;RL&quot;</span>,</span>
<span id="cb460-3"><a href="ggplot2.html#cb460-3"></a>                    <span class="st">&quot;Peruvian Vipertooth&quot;</span> =<span class="st"> &quot;PV&quot;</span>,</span>
<span id="cb460-4"><a href="ggplot2.html#cb460-4"></a>                    <span class="st">&quot;Ukrainian Ironbelly&quot;</span> =<span class="st"> &quot;UI&quot;</span>,</span>
<span id="cb460-5"><a href="ggplot2.html#cb460-5"></a>                    <span class="st">&quot;Norwegian Ridgeback&quot;</span> =<span class="st"> &quot;NR&quot;</span>,</span>
<span id="cb460-6"><a href="ggplot2.html#cb460-6"></a>                    <span class="st">&quot;Common Welsh Green&quot;</span> =<span class="st"> &quot;CWG&quot;</span>,</span>
<span id="cb460-7"><a href="ggplot2.html#cb460-7"></a>                    <span class="st">&quot;Swedish Short-Snout&quot;</span> =<span class="st"> &quot;SSS&quot;</span>,</span>
<span id="cb460-8"><a href="ggplot2.html#cb460-8"></a>                    <span class="st">&quot;Chinese Fireball&quot;</span> =<span class="st"> &quot;CF&quot;</span>,</span>
<span id="cb460-9"><a href="ggplot2.html#cb460-9"></a>                    <span class="st">&quot;Hungarian Horntail&quot;</span> =<span class="st"> &quot;HH&quot;</span>,</span>
<span id="cb460-10"><a href="ggplot2.html#cb460-10"></a>                    <span class="st">&quot;Antipodean Opaleye&quot;</span> =<span class="st"> &quot;AO&quot;</span>)</span>
<span id="cb460-11"><a href="ggplot2.html#cb460-11"></a>  </span>
<span id="cb460-12"><a href="ggplot2.html#cb460-12"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb460-13"><a href="ggplot2.html#cb460-13"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb460-14"><a href="ggplot2.html#cb460-14"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_class =</span> <span class="kw">factor</span>(age_class, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile&quot;</span>,</span>
<span id="cb460-15"><a href="ggplot2.html#cb460-15"></a>                                                  <span class="st">&quot;Subadult&quot;</span>,</span>
<span id="cb460-16"><a href="ggplot2.html#cb460-16"></a>                                                  <span class="st">&quot;Adult&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb460-17"><a href="ggplot2.html#cb460-17"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm, <span class="dt">color =</span> age_class)) <span class="op">+</span></span>
<span id="cb460-18"><a href="ggplot2.html#cb460-18"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb460-19"><a href="ggplot2.html#cb460-19"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>species, <span class="dt">labeller =</span> <span class="kw">labeller</span>(species_labels, </span>
<span id="cb460-20"><a href="ggplot2.html#cb460-20"></a>                                            <span class="dt">species =</span> species_labels)) <span class="op">+</span></span>
<span id="cb460-21"><a href="ggplot2.html#cb460-21"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;Age class&quot;</span>) <span class="op">+</span></span>
<span id="cb460-22"><a href="ggplot2.html#cb460-22"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Juvenile (&lt; 1 year)&quot;</span>,</span>
<span id="cb460-23"><a href="ggplot2.html#cb460-23"></a>                                 <span class="st">&quot;Subadult (2-3 years)&quot;</span>,</span>
<span id="cb460-24"><a href="ggplot2.html#cb460-24"></a>                                 <span class="st">&quot;Adult (&gt; 3 years)&quot;</span>)) <span class="op">+</span></span>
<span id="cb460-25"><a href="ggplot2.html#cb460-25"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb460-26"><a href="ggplot2.html#cb460-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg23-1.png" width="672" /></p>
</div>
<div id="error-bars" class="section level3">
<h3><span class="header-section-number">14.3.11</span> Error bars</h3>
<p>Let’s look at the content of some dragon diet samples, for a change. What do
dragons like to eat most?</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="ggplot2.html#cb461-1"></a><span class="kw">ggplot</span>(diet, <span class="kw">aes</span>(<span class="dt">x =</span> item)) <span class="op">+</span></span>
<span id="cb461-2"><a href="ggplot2.html#cb461-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb461-3"><a href="ggplot2.html#cb461-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot; &quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Count&quot;</span>) <span class="op">+</span></span>
<span id="cb461-4"><a href="ggplot2.html#cb461-4"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg24-1.png" width="672" /></p>
<p>Looks like they really like to eat domestic goats, huh? Let’s look at that in
terms of relative frequency rather than count:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="ggplot2.html#cb462-1"></a><span class="kw">ggplot</span>(diet, <span class="kw">aes</span>(<span class="dt">x =</span> item)) <span class="op">+</span></span>
<span id="cb462-2"><a href="ggplot2.html#cb462-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span>), <span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb462-3"><a href="ggplot2.html#cb462-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot; &quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Relative frequency&quot;</span>) <span class="op">+</span></span>
<span id="cb462-4"><a href="ggplot2.html#cb462-4"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg25-1.png" width="672" /></p>
<p>Do different species like to eat different things?</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="ggplot2.html#cb463-1"></a>diet <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb463-2"><a href="ggplot2.html#cb463-2"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb463-3"><a href="ggplot2.html#cb463-3"></a><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> item)) <span class="op">+</span></span>
<span id="cb463-4"><a href="ggplot2.html#cb463-4"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span>), <span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb463-5"><a href="ggplot2.html#cb463-5"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>species) <span class="op">+</span></span>
<span id="cb463-6"><a href="ggplot2.html#cb463-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot; &quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Relative frequency&quot;</span>) <span class="op">+</span></span>
<span id="cb463-7"><a href="ggplot2.html#cb463-7"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg26-1.png" width="672" /></p>
<p>For each diet item, we can summarize the mean relative frequency in diet samples
across species, calculate a standard deviation, and plot it as an error bar.
Because we are plotting values that we calculate manually instead of using
<code>geom_bar</code> to count <strong>and</strong> plot, we need to use <code>geom_col</code> instead:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="ggplot2.html#cb464-1"></a><span class="co"># This is the count by item for each species</span></span>
<span id="cb464-2"><a href="ggplot2.html#cb464-2"></a>item_count &lt;-<span class="st"> </span>diet <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb464-3"><a href="ggplot2.html#cb464-3"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb464-4"><a href="ggplot2.html#cb464-4"></a><span class="st">  </span><span class="kw">group_by</span>(species, item) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb464-5"><a href="ggplot2.html#cb464-5"></a><span class="st">  </span><span class="kw">tally</span>()</span>
<span id="cb464-6"><a href="ggplot2.html#cb464-6"></a></span>
<span id="cb464-7"><a href="ggplot2.html#cb464-7"></a><span class="co"># This is the total number of items per species</span></span>
<span id="cb464-8"><a href="ggplot2.html#cb464-8"></a>tot_items &lt;-<span class="st"> </span>diet <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb464-9"><a href="ggplot2.html#cb464-9"></a><span class="st">  </span><span class="kw">left_join</span>(dragons, <span class="dt">by =</span> <span class="st">&quot;dragon_id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb464-10"><a href="ggplot2.html#cb464-10"></a><span class="st">  </span><span class="kw">group_by</span>(species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb464-11"><a href="ggplot2.html#cb464-11"></a><span class="st">  </span><span class="kw">tally</span>()</span>
<span id="cb464-12"><a href="ggplot2.html#cb464-12"></a></span>
<span id="cb464-13"><a href="ggplot2.html#cb464-13"></a><span class="co"># Divide to get relative frequency</span></span>
<span id="cb464-14"><a href="ggplot2.html#cb464-14"></a>item_count &lt;-<span class="st"> </span>item_count <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb464-15"><a href="ggplot2.html#cb464-15"></a><span class="st">  </span><span class="kw">left_join</span>(tot_items, <span class="dt">by =</span> <span class="st">&quot;species&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb464-16"><a href="ggplot2.html#cb464-16"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rel_freq =</span> n.x<span class="op">/</span>n.y)</span>
<span id="cb464-17"><a href="ggplot2.html#cb464-17"></a></span>
<span id="cb464-18"><a href="ggplot2.html#cb464-18"></a><span class="co"># Calculate mean and sd for each item across species</span></span>
<span id="cb464-19"><a href="ggplot2.html#cb464-19"></a>rf &lt;-<span class="st"> </span>item_count <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb464-20"><a href="ggplot2.html#cb464-20"></a><span class="st">  </span><span class="kw">group_by</span>(item) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb464-21"><a href="ggplot2.html#cb464-21"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_rf =</span> <span class="kw">mean</span>(rel_freq), <span class="dt">sd_rf =</span> <span class="kw">sd</span>(rel_freq))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="ggplot2.html#cb466-1"></a><span class="kw">ggplot</span>(rf, <span class="kw">aes</span>(<span class="dt">x =</span> item, <span class="dt">y =</span> mean_rf)) <span class="op">+</span></span>
<span id="cb466-2"><a href="ggplot2.html#cb466-2"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb466-3"><a href="ggplot2.html#cb466-3"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean_rf <span class="op">-</span><span class="st"> </span>sd_rf,</span>
<span id="cb466-4"><a href="ggplot2.html#cb466-4"></a>                    <span class="dt">ymax =</span> mean_rf <span class="op">+</span><span class="st"> </span>sd_rf),</span>
<span id="cb466-5"><a href="ggplot2.html#cb466-5"></a>                <span class="dt">width =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb466-6"><a href="ggplot2.html#cb466-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot; &quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Relative frequency&quot;</span>) <span class="op">+</span></span>
<span id="cb466-7"><a href="ggplot2.html#cb466-7"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg27-1.png" width="672" /></p>
<p>We can also change the color to match the bars so that only the top part of the
error bar is visible:</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="ggplot2.html#cb467-1"></a><span class="kw">ggplot</span>(rf, <span class="kw">aes</span>(<span class="dt">x =</span> item, <span class="dt">y =</span> mean_rf)) <span class="op">+</span></span>
<span id="cb467-2"><a href="ggplot2.html#cb467-2"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb467-3"><a href="ggplot2.html#cb467-3"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean_rf <span class="op">-</span><span class="st"> </span>sd_rf,</span>
<span id="cb467-4"><a href="ggplot2.html#cb467-4"></a>                    <span class="dt">ymax =</span> mean_rf <span class="op">+</span><span class="st"> </span>sd_rf),</span>
<span id="cb467-5"><a href="ggplot2.html#cb467-5"></a>                <span class="dt">width =</span> <span class="fl">0.3</span>,</span>
<span id="cb467-6"><a href="ggplot2.html#cb467-6"></a>                <span class="dt">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span></span>
<span id="cb467-7"><a href="ggplot2.html#cb467-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot; &quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Relative frequency&quot;</span>) <span class="op">+</span></span>
<span id="cb467-8"><a href="ggplot2.html#cb467-8"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg28-1.png" width="672" /></p>
<p>We can also represent these as points with error bars:</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="ggplot2.html#cb468-1"></a><span class="kw">ggplot</span>(rf, <span class="kw">aes</span>(<span class="dt">x =</span> item, <span class="dt">y =</span> mean_rf)) <span class="op">+</span></span>
<span id="cb468-2"><a href="ggplot2.html#cb468-2"></a><span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean_rf <span class="op">-</span><span class="st"> </span>sd_rf,</span>
<span id="cb468-3"><a href="ggplot2.html#cb468-3"></a>                    <span class="dt">ymax =</span> mean_rf <span class="op">+</span><span class="st"> </span>sd_rf),</span>
<span id="cb468-4"><a href="ggplot2.html#cb468-4"></a>                <span class="dt">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span></span>
<span id="cb468-5"><a href="ggplot2.html#cb468-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot; &quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Relative frequency&quot;</span>) <span class="op">+</span></span>
<span id="cb468-6"><a href="ggplot2.html#cb468-6"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg29-1.png" width="672" /></p>
</div>
<div id="plot-model-predictions-with-uncertainty" class="section level3">
<h3><span class="header-section-number">14.3.12</span> Plot model predictions with uncertainty</h3>
<p>Oftentimes you’ll find yourself wanting to make a plot with predictions from
some kind of linear model, showing the confidence intervals around the mean
estimate. This can be done by combining the <code>geom_line</code> function with <code>geom_ribbon</code>.
Let’s go back to the linear regression model that we ran to quantify the
correlation between total body length and wingspan. We can get model predictions
for that model, calculate 95% confidence intervals using the standard error,
and make a plot where the model predictions are overlaid to the raw data points:</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="ggplot2.html#cb469-1"></a><span class="co"># Get model predictions for the original values of x</span></span>
<span id="cb469-2"><a href="ggplot2.html#cb469-2"></a>mod_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(reg, </span>
<span id="cb469-3"><a href="ggplot2.html#cb469-3"></a>        <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)</span>
<span id="cb469-4"><a href="ggplot2.html#cb469-4"></a></span>
<span id="cb469-5"><a href="ggplot2.html#cb469-5"></a><span class="co"># Calculate 95% CIs from std error</span></span>
<span id="cb469-6"><a href="ggplot2.html#cb469-6"></a>preds &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">mean =</span> mod_pred<span class="op">$</span>fit,</span>
<span id="cb469-7"><a href="ggplot2.html#cb469-7"></a>                    <span class="dt">upr =</span> mod_pred<span class="op">$</span>fit <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>mod_pred<span class="op">$</span>se.fit,</span>
<span id="cb469-8"><a href="ggplot2.html#cb469-8"></a>                    <span class="dt">lwr =</span> mod_pred<span class="op">$</span>fit <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>mod_pred<span class="op">$</span>se.fit)</span>
<span id="cb469-9"><a href="ggplot2.html#cb469-9"></a></span>
<span id="cb469-10"><a href="ggplot2.html#cb469-10"></a><span class="co"># Plot</span></span>
<span id="cb469-11"><a href="ggplot2.html#cb469-11"></a>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb469-12"><a href="ggplot2.html#cb469-12"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm)) <span class="op">+</span></span>
<span id="cb469-13"><a href="ggplot2.html#cb469-13"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> preds<span class="op">$</span>lwr, <span class="dt">ymax =</span> preds<span class="op">$</span>upr), </span>
<span id="cb469-14"><a href="ggplot2.html#cb469-14"></a>              <span class="dt">fill =</span> <span class="st">&quot;gray90&quot;</span>) <span class="op">+</span></span>
<span id="cb469-15"><a href="ggplot2.html#cb469-15"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> preds<span class="op">$</span>mean), <span class="dt">color =</span> <span class="st">&quot;darkmagenta&quot;</span>, <span class="dt">size =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb469-16"><a href="ggplot2.html#cb469-16"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;darkmagenta&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb469-17"><a href="ggplot2.html#cb469-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>) <span class="op">+</span></span>
<span id="cb469-18"><a href="ggplot2.html#cb469-18"></a><span class="st">  </span><span class="kw">theme_minimal</span>() </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg30-1.png" width="672" /></p>
<p>The global aesthetics that I’m using here are those for the raw data. Then in
<code>geom_line</code> I override the y aesthetic by replacing it with the mean model
prediction for wingspan. <code>geom_ribbon</code> does not take as input a y aesthetic
because it’s a range, not a single line, so the required aesthetics here are
<code>ymin</code> and <code>ymax</code>. Notice that the order in which I put the layers determines
what goes on the background and what’s in the foreground: I wanted the ribbon to
be in the back, the line to be on top of the ribbon (not hidden behind it), and
the points on top (or the ribbon would cover them) with some transparency.</p>
</div>
<div id="plot-paths-of-ordered-observations" class="section level3">
<h3><span class="header-section-number">14.3.13</span> Plot paths of ordered observations</h3>
<p>In our last plot, we used <code>geom_line</code> to plot our prediction curve. The
counterpart of <code>geom_line</code> is <code>geom_path</code>, which also plots lines but in the
order in which they appear in the data, not based on consecutive values of x.
This is helpful in some situations, for example to plot movement tracks from
telemetry data. Let’s plot the dragon GPS data:</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="ggplot2.html#cb470-1"></a>telemetry <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb470-2"><a href="ggplot2.html#cb470-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> utm_x, <span class="dt">y =</span> utm_y, <span class="dt">color =</span> dragon_id)) <span class="op">+</span></span>
<span id="cb470-3"><a href="ggplot2.html#cb470-3"></a><span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span></span>
<span id="cb470-4"><a href="ggplot2.html#cb470-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;UTM Easting&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;UTM Northing&quot;</span>) <span class="op">+</span></span>
<span id="cb470-5"><a href="ggplot2.html#cb470-5"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb470-6"><a href="ggplot2.html#cb470-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg31-1.png" width="672" /></p>
</div>
</div>
<div id="colorblind-friendly-plots-with-viridis" class="section level2">
<h2><span class="header-section-number">14.4</span> Colorblind-friendly plots with <code>viridis</code></h2>
<p>Making plots accessible and readable to everyone is an important part of
communicating science. The package <code>viridis</code> makes it easy to make your plots
colorblind-friendly. It includes several different color palettes that have been
carefully engineered so that colorblind people can tell apart all the colors
and the variation in hue scales linearly with the variation in the underlying
numerical values. <code>ggplot2</code> integrates with <code>viridis</code> seamlessly so it’s easy
to transform your plots using <code>viridis</code> color palettes. Let’s demonstrate it
with the telemetry plot we just made:</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="ggplot2.html#cb471-1"></a>telemetry <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb471-2"><a href="ggplot2.html#cb471-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> utm_x, <span class="dt">y =</span> utm_y, <span class="dt">color =</span> dragon_id)) <span class="op">+</span></span>
<span id="cb471-3"><a href="ggplot2.html#cb471-3"></a><span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span></span>
<span id="cb471-4"><a href="ggplot2.html#cb471-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;UTM Easting&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;UTM Northing&quot;</span>) <span class="op">+</span></span>
<span id="cb471-5"><a href="ggplot2.html#cb471-5"></a><span class="st">  </span><span class="kw">scale_color_viridis_d</span>() <span class="op">+</span></span>
<span id="cb471-6"><a href="ggplot2.html#cb471-6"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb471-7"><a href="ggplot2.html#cb471-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg31b-1.png" width="672" /></p>
<p>To change the color palette to viridis, I added another layer to my plot with
the function <code>scale_color_viridis_d</code>. The “d” at the end stands for “discrete”,
because in this case the colors are assigned based on a categorical variable
(the dragon ID). If I were using a continuous variable, I would have used the
function <code>scale_color_viridis_c</code>. If I wanted to apply the palette to a fill
parameter rather than a color parameter, I would have used the function
<code>scale_fill_viridis_d</code>. The one I plotted is the standard viridis palette, but
there are others to choose from (check out the viridis vignette!) For instance,
this one is called <code>plasma</code>:</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="ggplot2.html#cb472-1"></a>telemetry <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb472-2"><a href="ggplot2.html#cb472-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> utm_x, <span class="dt">y =</span> utm_y, <span class="dt">color =</span> dragon_id)) <span class="op">+</span></span>
<span id="cb472-3"><a href="ggplot2.html#cb472-3"></a><span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span></span>
<span id="cb472-4"><a href="ggplot2.html#cb472-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;UTM Easting&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;UTM Northing&quot;</span>) <span class="op">+</span></span>
<span id="cb472-5"><a href="ggplot2.html#cb472-5"></a><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="op">+</span></span>
<span id="cb472-6"><a href="ggplot2.html#cb472-6"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb472-7"><a href="ggplot2.html#cb472-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg32-1.png" width="672" /></p>
</div>
<div id="arranging-multiple-plots-together-with-patchwork" class="section level2">
<h2><span class="header-section-number">14.5</span> Arranging multiple plots together with <code>patchwork</code></h2>
<div class="figure" style="text-align: center"><span id="fig:gg33"></span>
<img src="img/patchwork_1.jpg" alt="Artwork by Allison Horst" width="80%" />
<p class="caption">
Figure 14.2: Artwork by Allison Horst
</p>
</div>
<p>The package <code>patchwork</code> allows you to combine and arrange multiple plots into
a single plot with several panels. Let’s load in the package (after installing
it):</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="ggplot2.html#cb473-1"></a><span class="kw">library</span>(patchwork)</span></code></pre></div>
<p>The first step to combine different plots is
to save each plot by assigning it its own name. Each will be stored in the
environment as a <code>ggplot2</code> object. For example, let’s take our diet barplot,
our regression prediction plot, and our telemetry one. We’ll call these <code>p1</code>,
<code>p2</code>, and <code>p3</code>:</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="ggplot2.html#cb474-1"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(rf, <span class="kw">aes</span>(<span class="dt">x =</span> item, <span class="dt">y =</span> mean_rf)) <span class="op">+</span></span>
<span id="cb474-2"><a href="ggplot2.html#cb474-2"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb474-3"><a href="ggplot2.html#cb474-3"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean_rf <span class="op">-</span><span class="st"> </span>sd_rf,</span>
<span id="cb474-4"><a href="ggplot2.html#cb474-4"></a>                    <span class="dt">ymax =</span> mean_rf <span class="op">+</span><span class="st"> </span>sd_rf),</span>
<span id="cb474-5"><a href="ggplot2.html#cb474-5"></a>                <span class="dt">width =</span> <span class="fl">0.3</span>,</span>
<span id="cb474-6"><a href="ggplot2.html#cb474-6"></a>                <span class="dt">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="op">+</span></span>
<span id="cb474-7"><a href="ggplot2.html#cb474-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot; &quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Relative frequency&quot;</span>) <span class="op">+</span></span>
<span id="cb474-8"><a href="ggplot2.html#cb474-8"></a><span class="st">  </span><span class="kw">theme_minimal</span>()</span>
<span id="cb474-9"><a href="ggplot2.html#cb474-9"></a></span>
<span id="cb474-10"><a href="ggplot2.html#cb474-10"></a>p2 &lt;-<span class="st"> </span>morphometrics <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb474-11"><a href="ggplot2.html#cb474-11"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> total_body_length_cm, <span class="dt">y =</span> wingspan_cm)) <span class="op">+</span></span>
<span id="cb474-12"><a href="ggplot2.html#cb474-12"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> preds<span class="op">$</span>lwr, <span class="dt">ymax =</span> preds<span class="op">$</span>upr), </span>
<span id="cb474-13"><a href="ggplot2.html#cb474-13"></a>              <span class="dt">fill =</span> <span class="st">&quot;gray90&quot;</span>) <span class="op">+</span></span>
<span id="cb474-14"><a href="ggplot2.html#cb474-14"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> preds<span class="op">$</span>mean), <span class="dt">color =</span> <span class="st">&quot;darkmagenta&quot;</span>, <span class="dt">size =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb474-15"><a href="ggplot2.html#cb474-15"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;darkmagenta&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb474-16"><a href="ggplot2.html#cb474-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total body length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Wingspan (cm)&quot;</span>) <span class="op">+</span></span>
<span id="cb474-17"><a href="ggplot2.html#cb474-17"></a><span class="st">  </span><span class="kw">theme_minimal</span>() </span>
<span id="cb474-18"><a href="ggplot2.html#cb474-18"></a></span>
<span id="cb474-19"><a href="ggplot2.html#cb474-19"></a>p3 &lt;-<span class="st"> </span>telemetry <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb474-20"><a href="ggplot2.html#cb474-20"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> utm_x, <span class="dt">y =</span> utm_y, <span class="dt">color =</span> dragon_id)) <span class="op">+</span></span>
<span id="cb474-21"><a href="ggplot2.html#cb474-21"></a><span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span></span>
<span id="cb474-22"><a href="ggplot2.html#cb474-22"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;UTM Easting&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;UTM Northing&quot;</span>) <span class="op">+</span></span>
<span id="cb474-23"><a href="ggplot2.html#cb474-23"></a><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="op">+</span></span>
<span id="cb474-24"><a href="ggplot2.html#cb474-24"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb474-25"><a href="ggplot2.html#cb474-25"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p>Now we can decide on the arrangement for these plots. The syntax for arranging
plots uses combinations of three symbols: <code>+</code>, <code>/</code>, and <code>|</code>. Using <code>+</code> is the
simplest option and it can be combined with the <code>plot_layout</code> function to tweak
how many rows and columns the plots are arranged on. If no layout is specified,
plots are aligned in row order:</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="ggplot2.html#cb475-1"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span>p3 </span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg35-1.png" width="672" /></p>
<p>But we can specify that we want them in 2 rows, in which case patchwork will
fill the first row before starting the next:</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="ggplot2.html#cb476-1"></a>p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg36-1.png" width="672" /></p>
<p>If we want the first plot to appear alone on the first row and the last two on
the second row, we can enforce hierarchy with parentheses:</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="ggplot2.html#cb477-1"></a>p1 <span class="op">+</span><span class="st"> </span>(p2 <span class="op">+</span><span class="st"> </span>p3) <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg37-1.png" width="672" /></p>
<p>The symbol <code>|</code> means “side by side” and the symbol <code>/</code> means “one on top of
each other”. We can combine these to obtain any layout we want:</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="ggplot2.html#cb478-1"></a>p1 <span class="op">|</span><span class="st"> </span>p2 <span class="op">/</span><span class="st"> </span>p3</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg38-1.png" width="672" /></p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="ggplot2.html#cb479-1"></a>(p1 <span class="op">|</span><span class="st"> </span>p2) <span class="op">/</span><span class="st"> </span>p3</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg38-2.png" width="672" /></p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="ggplot2.html#cb480-1"></a>(p1 <span class="op">/</span><span class="st"> </span>p2) <span class="op">|</span><span class="st"> </span>p3</span></code></pre></div>
<p><img src="reproducible-science_files/figure-html/gg38-3.png" width="672" /></p>
</div>
<div id="saving-plots" class="section level2">
<h2><span class="header-section-number">14.6</span> Saving plots</h2>
<p>Rule number 1: never, EVER, save a plot by clicking <em>Export</em> on the RStudio plot
panel. You will have so little control over the resolution, scale, aspect ratio,
and format of your plot that the result is guaranteed to be disappointing.
Instead, use <code>ggsave</code>! <code>ggsave</code> is the <code>ggplot2</code> function that allows you to
save your plots controlling and fine-tuning every detail of how they will appear
in the end. By default, if you don’t assign a name to a plot and specify its
name in <code>ggsave</code>, it will assume you want to save the last plot you ran. You’ll
need to give it a path to the folder where you want the file saved, including
the name you want to give to the file:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="ggplot2.html#cb481-1"></a><span class="kw">ggsave</span>(<span class="dt">filename =</span> <span class="st">&quot;img/patchwork1.tiff&quot;</span>, </span>
<span id="cb481-2"><a href="ggplot2.html#cb481-2"></a>       <span class="dt">device =</span> <span class="st">&quot;tiff&quot;</span>, <span class="co"># tiff is the best format for saving publication-quality figures</span></span>
<span id="cb481-3"><a href="ggplot2.html#cb481-3"></a>       <span class="dt">width =</span> <span class="dv">14</span>, <span class="co"># define the width of the plot in your units of choice</span></span>
<span id="cb481-4"><a href="ggplot2.html#cb481-4"></a>       <span class="dt">height =</span> <span class="dv">8</span>, <span class="co"># define the height of the plot in your units of choice</span></span>
<span id="cb481-5"><a href="ggplot2.html#cb481-5"></a>       <span class="dt">units =</span> <span class="st">&quot;in&quot;</span>, <span class="co"># define your units of choice (&quot;in&quot; stands for inches)</span></span>
<span id="cb481-6"><a href="ggplot2.html#cb481-6"></a>       <span class="dt">dpi =</span> <span class="dv">400</span>) <span class="co"># you can control exactly how many dots per inches your plot has, which comes in handy when the journal guidelines have a specific requirement</span></span></code></pre></div>
<p>Saving plots always requires a bit of back and forth: first, you guesstimate
the right width and height, then you save the file, then you open it and look at
it, then you go back to the code with any tweaks until you’re happy with it.</p>
</div>
<div id="references" class="section level2">
<h2><span class="header-section-number">14.7</span> References</h2>
<ul>
<li><a href="https://ggplot2.tidyverse.org/" class="uri">https://ggplot2.tidyverse.org/</a></li>
<li><a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html" class="uri">https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html</a></li>
<li><a href="https://patchwork.data-imaginist.com/" class="uri">https://patchwork.data-imaginist.com/</a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tidyverse.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="geospatial.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["reproducible-science.pdf", "reproducible-science.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
